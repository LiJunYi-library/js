class ListArray extends Array{constructor(...e){super(...e),Object.defineProperty(this,"events",{value:{},writable:!0,enumerable:!1,configurable:!1})}addEventListener(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}removeEventListener(e,t){this.events[e]||(this.events[e]=[]),arrayRemove(this.events[e],t)}onChange(e,...t){this.events.change instanceof Array&&this.events.change.forEach((i=>i(e,...t))),this.events[e]instanceof Array&&this.events[e].forEach((e=>e(...t)))}copyWithin(...e){let t=super.copyWithin(...e);return this?.onChange?.("copyWithin",...e),t}fill(...e){let t=super.fill(...e);return this?.onChange?.("fill",...e),t}pop(...e){let t=super.pop(...e);return this?.onChange?.("pop",...e),t}push(...e){let t=super.push(...e);return this?.onChange?.("push",...e),t}shift(...e){let t=super.shift(...e);return this?.onChange?.("shift",...e),t}unshift(...e){let t=super.unshift(...e);return this?.onChange?.("unshift",...e),t}splice(...e){let t=super.splice(...e);return this?.onChange?.("splice",...e),t}sort(...e){let t=super.sort(...e);return this?.onChange?.("sort",...e),t}reverse(...e){let t=super.reverse(...e);return this?.onChange?.("reverse",...e),t}}function arrayAt(e,t){return e[t<0?e.length+t:t]}function arrayLoop(e,t){for(let i=0;i<e;i++)if(!1===t(i))return}function arrayLoopMap(e,t){const i=[];for(let s=0;s<e;s++)i.push(t(s));return i}function arrayRemove(e=[],t){const i=e.findIndex((e=>e===t));return~i&&e.splice(i,1),e}function arrayBinarySearch(e=(e,t)=>e.right=t-1,t=[],i,s){const o={left:0,right:t.length-1,result:-1};for(;o.left<=o.right;){const n=Math.floor((o.left+o.right)/2),r=t[n];i(r)?(o.result=n,e(o,n,r)):s(r)?o.left=n+1:o.right=n-1}return o.result}function arrayBinaryFindIndex(e=[],t,i){return arrayBinarySearch(((e,t)=>{e.right=t-1}),e,t,i)}function arrayRewriteFunction(e=[],t){const i={},s={};return["copyWithin","fill","push","pop","shift","unshift","splice","sort","reverse"].forEach((o=>{i[o]=e[o],s[o]={value:function(...s){const n=i[o].call(e,...s);return t instanceof Function&&t?.("name",...s),n},writable:!0,enumerable:!1,configurable:!1}})),Object.defineProperties(e,s),e}function useQueue(e={}){const t={onBegin:()=>{},onFinish:()=>{},onPush:()=>{},onPushed:()=>{},onRemove:()=>{},onRemoved:()=>{},...e},i=[];return{queue:i,push:function(e){0===i.length&&t.onBegin(i,e),t.onPush(i,e),i.includes(e)&&arrayRemove(i,e),i.push(e),t.onPushed(i,e)},remove:function(e){t.onRemove(i,e),arrayRemove(i,e),t.onRemoved(i,e),0===i.length&&t.onFinish(i,e)},change:function(e){}}}function setTimeoutPromise(e=0,t=e){return new Promise((i=>setTimeout((()=>i(t)),e)))}function requestAnimationFramePromise(e){return new Promise((t=>requestAnimationFrame((()=>t(e)))))}function animationDebounced(e){let t;return function(...i){cancelAnimationFrame(t),t=requestAnimationFrame((t=>{e(...i)}))}}Array.prototype.at||(Array.prototype.at=function(...e){return arrayAt(this,...e)});const rainbow$1=(()=>{const e=document.createElement("r-overlay");return document.body.append(e),{overlay:e,zIndex:100,zIndexAdd:3,overlayQueue:useQueue(),dialogQueue:useQueue(),customRender(e,t){t.innerHTML="",t.append(e)}}})();function deleteKey(e,t,i){for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s))try{i&&(t[s]=""),delete t[s]}catch(e){}}function assignStyle(e,t){for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]="",e[i]=t[i])}function convertToCamelCase(e){if(e.includes("-")){const t=e.split("-");return t[0]+t.slice(1).map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join("")}return e}function camelCaseToKebabCase(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}window.rainbow=rainbow$1;class RainbowEvent extends Event{constructor(e,t,i){if(super(e,t),this.detail=i,i instanceof Array)for(const e in i)try{void 0===this[e]&&(this[e]=i[e])}catch(e){console.warn(e)}}}function createCustomEvent(e,t,i={}){const s=new CustomEvent(e,{bubbles:!0,cancelable:!0,...i});for(const e in t)try{void 0===s[e]&&(s[e]=t[e])}catch(e){console.warn(e)}return s}function renderChildren(e={}){const t={parentNode:void 0,...e};let i,s=new Map;return{renderList:function(e=[],o){const n={beforeEach:()=>0,keyExtractor:(e,t)=>t,onCacheNode:()=>0,onCreateNode:()=>0,onDeleteNode:()=>0,onRemoveNode:()=>0,onBeforeInsertNode:()=>0,onInsertBeforeNode:()=>0,...o},r=new Map;i=void 0,n.beforeEach({cacheMap:s,pointer:i}),e.forEach(((e,o)=>{const l=n.keyExtractor(e,o);let a;n.onBeforeInsertNode(e,o,l),s.has(l)?(a=s.get(l),n.onCacheNode(a,e,o,l),i&&(i.nextSibling===a||t.parentNode.insertBefore(a,i.nextSibling)),i=a,s.delete(l),n.onDeleteNode(a,e,o,l)):(a=n.onCreateNode(e,o,l),i?t.parentNode.insertBefore(a,i?.nextSibling):t.parentNode.insertBefore(a,t.parentNode?.firstChild),i=a),n.onInsertBeforeNode(a,e,o,l),r.set(l,a)})),s.forEach(((e,t)=>{e.remove(),n.onRemoveNode(e,t)})),i=void 0,s=r}}}function createElement(e="div",t=""){const i=document.createElement(e);return i.setAttribute("part",t),i.className=t,i}function createSlot(e="slot",t="",i=t){const s=createElement(e,t);return s.setAttribute("name",i),s}function wipePX(e=""){return"number"==typeof e?e:(/px/.test(e)&&(e=e.replace(/px/g,"")),/\d+/.test(e)?Number(e):e)}function toggleClass(e,t,i="",s=""){t?(e.classList.add(i),e.classList.remove(s)):(e.classList.add(s),e.classList.remove(i))}function isNum(e){return"number"==typeof e}function Transition(e={}){const t={node:createElement(),eventNode:createElement(),dispatchNode:createElement(),formatterVisible:e=>e.value,name:"",...e},i={value:void 0,animateSymbol:1,finishSymbol:1,onTransitionend:()=>{i.finishSymbol=i.animateSymbol,t.node.classList.remove(`${t.name}-enter-active`),t.node.classList.remove(`${t.name}-leave-active`),t.node.classList.remove(`${t.name}-enter-to`),t.node.classList.remove(`${t.name}-leave-to`),t.formatterVisible(t.node)?(t.node.classList.remove(`${t.hideClassName}`),t.dispatchNode.dispatchEvent(createCustomEvent("afterEnter"))):(t.node.classList.add(`${t.hideClassName}`),t.dispatchNode.dispatchEvent(createCustomEvent("afterLeave")))},async show(){!0!==i.value&&(i.value=!0,t.node.classList.remove(`${t.hideClassName}`),t.node.classList.remove(`${t.name}-leave-from`),t.node.classList.remove(`${t.name}-leave-active`),t.node.classList.remove(`${t.name}-leave-to`),t.node.classList.add(`${t.name}-enter-from`),t.dispatchNode.dispatchEvent(createCustomEvent("beforeEnter")),i.animateSymbol===i.finishSymbol&&(i.animateSymbol=Symbol(),await requestAnimationFramePromise()),t.node.classList.remove(`${t.name}-enter-from`),t.node.classList.add(`${t.name}-enter-active`),t.node.classList.add(`${t.name}-enter-to`),t.dispatchNode.dispatchEvent(createCustomEvent("enter")),t.eventNode.removeEventListener("transitionend",this.onTransitionend),t.eventNode.addEventListener("transitionend",this.onTransitionend))},async hide(){!1!==i.value&&(i.value=!1,t.node.classList.remove(`${t.name}-enter-from`),t.node.classList.remove(`${t.name}-enter-active`),t.node.classList.remove(`${t.name}-enter-to`),t.node.classList.add(`${t.name}-leave-from`),t.dispatchNode.dispatchEvent(createCustomEvent("beforeLeave")),i.animateSymbol===i.finishSymbol&&(i.animateSymbol=Symbol(),await requestAnimationFramePromise()),t.node.classList.remove(`${t.name}-leave-from`),t.node.classList.add(`${t.name}-leave-active`),t.node.classList.add(`${t.name}-leave-to`),t.dispatchNode.dispatchEvent(createCustomEvent("leave")),t.eventNode.removeEventListener("transitionend",this.onTransitionend),t.eventNode.addEventListener("transitionend",this.onTransitionend))}};return i}const events=new Map;new MutationObserver((e=>{events.forEach(((t,i)=>{t instanceof Function&&t.call(i,e)}))})).observe(document,{subtree:!0,attributes:!0,attributeOldValue:!0});const treeAttrsChangeIMP={simult:{init(){this.$.changePropsRender&&events.set(this,(()=>this.$.changePropsRender()))},disconnected(){events.delete(this)}},settle:{init(){}},async:{init(){}}};function resizeObserverIMP(e={}){let t;const i={isOnlyResizeWidth:!1,isOnlyResizeHeight:!1,resizeCallback:void 0,resizeOptions:{},...e};let s={};return{simult:{init(){const e=i.resizeCallback?i.resizeCallback.bind(this):this.$debouncedRender.bind(this);try{t=new ResizeObserver(((...t)=>{let o={width:this.offsetWidth,height:this.offsetHeight};i.isOnlyResizeWidth&&s.width!==o.width&&e(...t),i.isOnlyResizeHeight&&s.height!==o.height&&e(...t),i.isOnlyResizeWidth||i.isOnlyResizeHeight||e(...t),s=o})),t.observe(this,i.resizeOptions)}catch(e){console.warn(e)}},disconnected(){t.disconnect(this)}}}}function treeObserverIMP(e={}){let t,i;const s={childrenResizeOptions:{},onChildrenSizeChange(){},resizeOptions:{},onSizeChange(){},onWidthChange(){},onHeightChange(){},mutationOptions:{childList:!0},onChildChange(){},onAttributeChange(){},...e};let o={offset:{}};return{simult:{init(){try{i=new ResizeObserver(((e,...t)=>{let i={width:this.offsetWidth,height:this.offsetHeight};o.offset.width!==i.width&&s.onWidthChange.call(this,e,i),o.offset.height!==i.height&&s.onHeightChange.call(this,e,i),o.offset.width===i.width&&o.offset.height===i.height||s.onSizeChange.call(this,e,i),o.offset=i,!1===e.some((e=>e.target===this))&&s.onChildrenSizeChange.call(this,e)})),i?.observe?.(this,s.resizeOptions)}catch(e){console.warn(e)}t=new MutationObserver(((e,...t)=>{for(let t of e)if("childList"===t.type){const e=Array.from(t.addedNodes).filter((e=>e.style)),o=Array.from(t.removedNodes).filter((e=>e.style));e.forEach((e=>i.observe(e,s.childrenResizeOptions))),o.forEach((e=>i.unobserve(e))),s.onChildChange.call(this,t)}else"attributes"===t.type&&s.onAttributeChange.call(this,t)})),t.observe(this,s.mutationOptions)},disconnected(){t.disconnect(this),i.disconnect(this)}}}}class RainbowElement extends HTMLElement{static $registerProps(e){const t=[],i={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t.push(s),e[s]?.default instanceof Function?i[s]=e[s].default(i):i[s]=e[s]?.default);return this.prototype.$types=e,this.prototype.$props=i,t}IMPS=[treeAttrsChangeIMP];$={self:this,getSlotContainer:e=>{const t=e?.getAttribute?.("solt");if(!t)return;const i=this.$slotContainer?.[t];return i},_getSC:(...e)=>this.$.getSlotContainer(...e),renderSolt:e=>{if(["r-template","template"].includes(e.localName)){const t=e.getAttribute("solt");return this.$slotContainer?.[t]?.append(e),e}return!1},isInitAttrs:!1,data:{},DATA:new Proxy({},{get:(e,t)=>this.$.data[camelCaseToKebabCase(t)]}),props:{...this.constructor.prototype.$props},resolveFunCss:{calc:(e,...t)=>e},resolveCss:(key,str="")=>{try{if("r-prop"===str)return this.$.props[key];const isAttrFun=/r-attr\([^\)]*?\)/.test(str);isAttrFun&&(str=this.$.props[key]);let cssVal=str.replace(/\d+px|\d+vw|\d+vh/g,(e=>/\d+px/.test(e)?Number(e.replaceAll("px","")):/\d+vw/.test(e)?Number(e.replaceAll("vw",""))/100*window.innerWidth:/\d+vh/.test(e)?Number(e.replaceAll("vh",""))/100*window.innerHeight:e));return/([^\(]*?)\([^\)]*?\)/.test(cssVal)?eval(`this.$.resolveFunCss.${cssVal}`):/^-?\d+(\.\d+)?$/.test(cssVal)?Number(cssVal):/.*?,.*?/.test(cssVal)?cssVal.trim().split(",").filter(Boolean):cssVal}catch(e){return str}},cache:{data:{},style:{},class:new Map},resolvePercentum:(e="",t=this,i=e=>e.offsetWidth)=>/\d+?%/.test(e)?i(t)*(e.replaceAll("%","")/100):e,resolvePercentumH:(e,t,i=e=>e.offsetHeight)=>this.$.resolvePercentum(e,t,i),setStyle:(e=()=>({}))=>{let t=e(this.$.data)||{},i=t;t instanceof Array&&(i=t.filter(Boolean).reduce(((e,t)=>(Object.assign(e,t),e)),{}));for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&(this.$.cache.style[e]!==i[e]&&(this.style[e]="",this.style[e]=i[e]),delete this.$.cache.style[e]);for(const e in this.$.cache.style)Object.prototype.hasOwnProperty.call(this.$.cache.style,e)&&(this.style[e]="");this.$.cache.style=i},setClass:(e=()=>[])=>{let t=e(this.$.data);void 0===t?.length&&(t=[t]),t=t.filter(Boolean);let i=new Map;t.forEach((e=>{i.set(e,e),this.$.cache.class.delete(e),this.classList.add(e)})),this.$.cache.class.forEach(((e,t)=>{this.classList.remove(e)})),this.$.cache.class=i},findParentByLocalName:(e,t=this)=>{if(!t)return;const i=t.parentNode;return i?e instanceof Array&&e.includes(i.localName)||i.localName===e?i:this.$.findParentByLocalName(e,i):void 0},findChildByLocalName:(e,t=this)=>t?e instanceof Array?e.map((e=>t.getElementsByTagName(e))).flat(1/0):t.getElementsByTagName(e):[],getOffsetTop:(e,t=0)=>{if(this.offsetParent===e)return t;let i=t+this.offsetTop;return this.$.getOffsetTop(this.offsetParent,i)},isAnimation:!1,transitionrun:()=>{this.$.isAnimation=!0},transitioncancel:()=>{this.$.isAnimation=!1},transitionend:()=>{this.$.isAnimation=!1},changePropsRender:e=>{let t=!1;const i={},s=window.getComputedStyle(this);for(const e in this.$.props)if(Object.prototype.hasOwnProperty.call(this.$.props,e)){if(e.startsWith("r-")){const t=s.getPropertyValue("--"+e).trim();i[e]=this.$.resolveCss(e,t)}else{const t=s.getPropertyValue(e).trim();i[e]=wipePX(t)}this.$.cache.data[e]!==i[e]&&(t=!0)}return this.$.data=i,this.$.cache.data=i,(t||!0===e)&&this.$debouncedRender(i),i},append:(...e)=>super.append(...e),appendChild:(...e)=>super.appendChild(...e),insertBefore:(...e)=>super.insertBefore(...e),removeChild:(...e)=>super.removeChild(...e)};constructor(...e){super(...e),this.IMPS.push(...this.$onRegisterIMPS?.()||[]),this.$debouncedRender=animationDebounced(((...e)=>this.$render(...e))),this.IMPS.map((e=>e?.simult))?.forEach((e=>e?.init?.call?.(this))),this.addEventListener("transitionrun",this.$.transitionrun),this.addEventListener("transitioncancel",this.$.transitioncancel),this.addEventListener("transitionend",this.$.transitionend)}$slotContainer={default:this};attributeChangedCallback(e,t,i){this.$.props[e]=i,!0===this.$.isInitAttrs&&this.$onAttributeChanged(e,t,i)}$onAttributeChanged(){this.IMPS.map((e=>e?.simult))?.forEach((e=>e?.changeAttr?.call?.(this))),this.$.changePropsRender()}connectedCallback(){this.$.isInitAttrs=!0,this.IMPS.map((e=>e?.simult))?.forEach((e=>e?.connected?.call?.(this))),this.$.changePropsRender()}adoptedCallback(){this.IMPS.map((e=>e?.simult))?.forEach((e=>e?.adopted?.call?.(this)))}disconnectedCallback(){this.removeEventListener("transitionrun",this.$.transitionrun),this.removeEventListener("transitioncancel",this.$.transitioncancel),this.removeEventListener("transitionend",this.$.transitionend),this.IMPS.map((e=>e?.simult))?.forEach((e=>e?.disconnected?.call?.(this)))}$onRegisterIMPS(){return[]}$render(){}}class RAbsolute extends RainbowElement{static observedAttributes=this.$registerProps({"r-position":[Boolean,String]})}class ROverlay extends RainbowElement{$$=(()=>({value:!1,transition:Transition({node:this,dispatchNode:this,eventNode:this,name:"r-overlay",hideClassName:"r-overlay-hide"})}))();set value(e){this.$$.value!==e&&(this.$$.value=e,this.$$.value?this.$$.transition.show():this.$$.transition.hide())}get value(){return this.$$.value}connectedCallback(...e){super.connectedCallback(...e),!1===this.value&&this.classList.add("r-overlay-hide"),this.$$.transition=Transition({node:this,dispatchNode:this,eventNode:this,name:"r-overlay",hideClassName:"r-overlay-hide"})}disconnectedCallback(...e){super.disconnectedCallback(...e)}}class RDialog extends RainbowElement{static observedAttributes=this.$registerProps({"r-orientation":String});$$=(()=>{const e=createElement("div","r-dialog-content");return{value:!1,content:e,defaultSlot:createSlot("slot","",""),transition:Transition({node:this,dispatchNode:this,eventNode:e,name:"r-dialog",hideClassName:"r-dialog-hide"}),onOverlayClick:e=>{e.stopPropagation(),console.log("onOverlayClick"),window.rainbow.overlayQueue.queue.at(-1)===this&&(this.value=!1,this.dispatchEvent(createCustomEvent("input",{value:!1})))},onDocumentClick:e=>{console.log("onDocumentClick",window.rainbow.overlayQueue.queue.length),this.value=!1,this.dispatchEvent(createCustomEvent("input",{value:!1}))},click:e=>{e.stopPropagation(),console.log("click")},open:()=>{const e=rainbow.dialogQueue.queue.at(-1);rainbow.zIndex=rainbow.zIndex+rainbow.zIndexAdd,this.style.zIndex=rainbow.zIndex,this.style.top="50px",rainbow.overlay.style.top="50px",this.$$.transition.show(),rainbow.overlay.value=!0,rainbow.overlayQueue.push(this),e&&e!==this&&(e.value=!1,e.dispatchEvent(createCustomEvent("input",{value:!1}))),rainbow.dialogQueue.push(this),rainbow.overlay.style.zIndex=(rainbow.overlayQueue.queue.at(-1)?.style?.zIndex??1)-1,rainbow.overlay.addEventListener("click",this.$$.onOverlayClick),document.removeEventListener("click",this.$$.onDocumentClick)},close:()=>{this.$$.transition.hide(),rainbow.overlayQueue.remove(this),rainbow.dialogQueue.remove(this),0===rainbow.overlayQueue.queue.length&&(rainbow.overlay.value=!1),rainbow.overlay.removeEventListener("click",this.$$.onOverlayClick),document.removeEventListener("click",this.$$.onDocumentClick)},afterLeave:()=>{rainbow.overlay.style.zIndex=(rainbow.overlayQueue.queue.at(-1)?.style?.zIndex??1)-1},afterEnter:()=>{}}})();set value(e){this.$$.value!==e&&(this.$$.value=e,this.$$.value?this.$$.open():this.$$.close())}get value(){return this.$$.value}constructor(...e){super(...e),this.attachShadow({mode:"open"}),this.$$.content.append(this.$$.defaultSlot),this.shadowRoot.appendChild(this.$$.content),this.addEventListener("afterEnter",this.$$.afterEnter),this.addEventListener("afterLeave",this.$$.afterLeave),this.addEventListener("click",this.$$.click)}connectedCallback(...e){super.connectedCallback(...e);const{rOrientation:t}=this.$.DATA;this.classList.add(`r-dialog-${t}`),!1===this.value&&this.classList.add("r-dialog-hide"),this.$$.transition=Transition({node:this,dispatchNode:this,eventNode:this.$$.content,name:"r-dialog-"+t,hideClassName:"r-dialog-hide"}),console.log(" connectedCallback ",t)}disconnectedCallback(...e){super.disconnectedCallback(...e)}}function createDialog(e){const t=document.createElement("r-dialog");function i(e){rainbow.customRender(e,t),t.value=!0}return document.body.appendChild(t),i.ele=t,i.close=()=>{t.value=!1},i}class RFalls extends RainbowElement{static observedAttributes=this.$registerProps({"r-min-auto-width":Number,"r-columns":{type:Number,default:2},"r-gap":{type:Number,default:0},"r-row-gap":{type:Number,default:0},"r-column-gap":{type:Number,default:0}});$onRegisterIMPS(){return[treeObserverIMP({onWidthChange(){this.$debouncedRender(this.$?.data)},onChildrenSizeChange(){this.$debouncedRender(this.$?.data)}})]}$render(){let{rMinAutoWidth:e,rColumns:t,rGap:i,rRowGap:s,rColumnGap:o}=this.$.DATA;const n=(()=>e?Math.floor(this.offsetWidth/e):t)();let r=o||i,l=s||i,a=e=>`calc( ${100/n*e}% - ${(n-1)*r/n*e}px + ${e*r}px )`;const c=arrayLoopMap(n,(e=>({height:0,left:a(e),top:0,index:e})));let h=`calc( ${100/n}% - ${(n-1)*r/n}px )`;Array.from(this.children).forEach((e=>{e.classList.add("r-falls-item"),e.style.width=h;let t=getMinHeightItem$1(c);t.height&&(t.height=t.height+l),e.style.left=t.left,e.style.top=t.height+"px",t.height=t.height+e.offsetHeight})),this.style.height=getMaxHeightItem$1(c).height+"px"}}function getMinHeightItem$1(e){let t=e[0];return e.forEach((e=>{e.height<t.height&&(t=e)})),t}function getMaxHeightItem$1(e){let t=e[0];return e.forEach((e=>{e.height>t.height&&(t=e)})),t}class RGrid extends RainbowElement{static observedAttributes=this.$registerProps({"r-columns":{type:Number,default:1},"r-min-auto-width":Number,"r-gap":[Number,String],"r-row-gap":[Number,String],"r-column-gap":[Number,String],"r-grid-wrap":String,"r-grid-stretch":String});$onRegisterIMPS(){return[resizeObserverIMP({isOnlyResizeWidth:!0})]}$render(){const{rGap:e,rRowGap:t,rColumnGap:i}=this.$.DATA;this.$.setStyle((()=>[{"grid-template-columns":`repeat(${this.$$columns}, 1fr)`,"grid-gap":e+"px","row-gap":(t||e)+"px","column-gap":(i||e)+"px"}])),this.$$doLayout()}get $$columns(){let{rColumns:e,rMinAutoWidth:t}=this.$.DATA;return t?Math.floor(this.offsetWidth/t):e}$$doLayout(){const{rGridWrap:e,rGridStretch:t}=this.$.DATA;let i=Array.from(this.children),s=i.map((e=>1*e.getAttribute("grid-column")||1)),o=1,n=[],r=this.$$columns+1;s.forEach(((i,s)=>{let l=o+i;if("wrap"===e){if(l>r){"stretch"===t&&n[s-1]&&(n[s-1].end=r),o=1;let e=o+i;l=e>r?r:e}}else l>r&&(l=r);n.push({start:o,end:l,index:s}),o+=i,o>this.$$columns&&(o=1)})),i.forEach(((e,t)=>{e.classList.add("r-grid-item"),e.style["grid-column-start"]=n[t].start,e.style["grid-column-end"]=n[t].end}))}}class RMove extends RainbowElement{static observedAttributes=this.$registerProps({top:Number,bottom:Number,left:Number,right:Number,"r-move-border-left":Number,"r-move-border-right":Number,"r-move-border-top":Number,"r-move-border-bottom":Number,"r-adsorb-border-left":Number,"r-adsorb-border-right":Number,"r-adsorb-border-top":Number,"r-adsorb-border-bottom":Number,"r-adsorb":String});$$={caches:{x:0,y:0},startTouche:{},onTouchstart:e=>{this.$$.startTouche=e.touches?.[0],e.stopPropagation();const t=window.getComputedStyle(this);this.$$.caches.x=wipePX(t.getPropertyValue("left").trim()),this.$$.caches.y=wipePX(t.getPropertyValue("top").trim()),this.style.transition="none"},onTouchmove:e=>{e.stopPropagation();const{rMoveBorderLeft:t,rMoveBorderTop:i,rMoveBorderRight:s,rMoveBorderBottom:o}=this.$.DATA,n=e.touches?.[0],r=this.parentNode.offsetWidth-this.offsetWidth-s,l=this.parentNode.offsetHeight-this.offsetHeight-o;let a=n.clientX-this.$$.startTouche.clientX+this.$$.caches.x,c=n.clientY-this.$$.startTouche.clientY+this.$$.caches.y;isNum(s)&&a>r&&(a=r),isNum(t)&&a<t&&(a=t),isNum(o)&&c>l&&(c=l),isNum(i)&&c<i&&(c=i),this.style.left=`${a}px`,this.style.top=`${c}px`,this.style.bottom="auto",this.style.right="auto"},onTouchend:e=>{e.stopPropagation();const t=window.getComputedStyle(this);let i=wipePX(t.getPropertyValue("left").trim()),s=wipePX(t.getPropertyValue("top").trim());const{rAdsorbBorderLeft:o,rAdsorbBorderTop:n,rAdsorbBorderRight:r,rAdsorbBorderBottom:l,rAdsorb:a}=this.$.DATA;let c=o||0,h=n||0;const d=this.parentNode.offsetWidth-this.offsetWidth-(r||0),$=this.parentNode.offsetHeight-this.offsetHeight-(l||0);let u=this.parentNode.offsetWidth-i-this.offsetWidth,v=this.parentNode.offsetHeight-s-this.offsetHeight;a&&this.$$.adsorb[a]({x:c,y:h,maxX:d,maxH:$,left:i,top:s,right:u,bottom:v})},adsorb:{com:()=>{this.style.transition="0.2s"},left:({x:e})=>{this.style.left=`${e}px`,this.$$.adsorb.com()},right:({maxX:e})=>{this.style.left=`${e}px`,this.$$.adsorb.com()},horizontal:({x:e,maxX:t,left:i})=>{i+this.offsetWidth/2>this.parentNode.offsetWidth/2&&(e=t),this.style.left=`${e}px`,this.$$.adsorb.com()},top:({y:e})=>{this.style.top=`${e}px`,this.$$.adsorb.com()},bottom:({maxH:e})=>{this.style.top=`${e}px`,this.$$.adsorb.com()},vertical:({y:e,maxH:t,top:i})=>{i+this.offsetHeight/2>this.parentNode.offsetHeight/2&&(e=t),this.style.top=`${e}px`,this.$$.adsorb.com()},nook:({y:e,maxH:t,top:i,x:s,maxX:o,left:n})=>{n+this.offsetWidth/2>this.parentNode.offsetWidth/2&&(s=o),i+this.offsetHeight/2>this.parentNode.offsetHeight/2&&(e=t),this.style.left=`${s}px`,this.style.top=`${e}px`,this.$$.adsorb.com()},nearby:({y:e,maxH:t,top:i,x:s,maxX:o,left:n,right:r,bottom:l})=>{let a=Math.min(n,r,l,i);n===a&&(this.style.left=`${s}px`),r===a&&(this.style.left=`${o}px`),i===a&&(this.style.top=`${e}px`),l===a&&(this.style.top=`${t}px`),this.$$.adsorb.com()}}};constructor(...e){super(...e),this.addEventListener("touchstart",this.$$.onTouchstart),this.addEventListener("touchmove",this.$$.onTouchmove),this.addEventListener("touchend",this.$$.onTouchend)}connectedCallback(...e){super.connectedCallback(...e)}disconnectedCallback(...e){super.disconnectedCallback(...e)}}const COMPUTE_INTERVAL=30;let currentView=document.createElement("div"),srcViews=[],timer;const customEventNameMap=new Map,compute={isGetPdownLock:!1,srcViews:[]};class SlideEvent extends CustomEvent{altKey=void 0;altitudeAngle=void 0;azimuthAngle=void 0;button=void 0;buttons=void 0;clientX=void 0;clientY=void 0;ctrlKey=void 0;currentTime=void 0;deltaAng=void 0;deltaC=void 0;deltaTime=void 0;deltaX=void 0;deltaY=void 0;direction=void 0;fromElement=void 0;getModifierState=void 0;getPredictedEvents=void 0;height=void 0;initMouseEvent=void 0;initUIEvent=void 0;isPrimary=void 0;layerX=void 0;layerY=void 0;metaKey=void 0;moveX=void 0;moveY=void 0;movementX=void 0;movementY=void 0;offsetX=void 0;offsetY=void 0;orientation=void 0;pageX=void 0;pageY=void 0;persistentDeviceId=void 0;pointerId=void 0;pointerType=void 0;pressure=void 0;relatedTarget=void 0;screenX=void 0;screenY=void 0;shiftKey=void 0;sourceCapabilities=void 0;speedX=void 0;speedY=void 0;srcViews=void 0;tangentialPressure=void 0;tiltX=void 0;tiltY=void 0;toElement=void 0;twist=void 0;velocityX=void 0;velocityY=void 0;view=void 0;which=void 0;width=void 0;x=void 0;y=void 0;constructor(e,t={}){super(e,t)}}function extendedSlideEvents(e=document.createElement("div"),t={}){function i(t,i){e.$$&&(e.$$[t]=i)}function s(e){i("parentViews",[...srcViews]),srcViews.push(e.currentTarget),i("srcViews",[...srcViews]),compute.isGetPdownLock=!1}function o(e){compute.isGetPdownLock||(compute.srcViews=[...srcViews],currentView=srcViews.at(-1),srcViews=[],compute.isGetPdownLock=!0),i("slideEventViews",[...compute.srcViews])}return{bindEvents:function(){e.addEventListener("pointerdown",s,{passive:!1,capture:!0}),e.addEventListener("pointerdown",o);let n={customEventName:"",direction:"",...t};n.customEventName&&(customEventNameMap.set(n.customEventName,n.customEventName),i("slideCustomEventName",n.customEventName))},destroy:function(){e.removeEventListener("pointerdown",s,{passive:!1,capture:!0}),e.removeEventListener("pointerdown",o)}}}function undefinedReturn(e,t){return isNaN(e)||void 0===e?t:e}function inheritPointerEvent(e,t={},i={bubbles:!0,cancelable:!0}){const s=new SlideEvent(e,i);for(const e in t)try{void 0===s[e]&&(s[e]=t[e])}catch(e){console.warn(e)}return s}function calcHypotenuse(e,t){return Math.sqrt(e*e+t*t)}function calculateAngle(e,t){return 360-(Math.atan2(t,e)*(180/Math.PI)+360)%360}(()=>{document.addEventListener("pointerdown",(function(h){clearTimeout(timer),a(h),c("slideDown",h),e=h,t=h,i=h,n=!1,r=!0,s=void 0,o=void 0,l=[]})),document.addEventListener("pointermove",(function(e){if(clearTimeout(timer),a(e),t=e,!n){if(e.deltaC>8){const t=e.deltaAng,i=315<=t||t<45,r=45<=t&&t<135,l=135<=t&&t<225,a=225<=t&&t<315;return i&&(s="right"),r&&(s="top"),l&&(s="left"),a&&(s="bottom"),(i||l)&&(o="horizontal"),(r||a)&&(o="vertical"),void(n=!0)}return}if(r)return c("slideStrat",e),e.moveX<0&&c("slideRightStrat",e),e.moveY<0&&c("slideBottomStrat",e),e.moveX>0&&c("slideLeftStrat",e),e.moveY>0&&c("slideTopStrat",e),0!==e.moveX&&c("slideHorizontalStrat",e),0!==e.moveY&&c("slideVerticalStrat",e),void(r=!1);c("slideMove",e),e.moveX<0&&c("slideRight",e);e.moveY<0&&c("slideBottom",e);e.moveX>0&&c("slideLeft",e);e.moveY>0&&c("slideTop",e);0!==e.moveX&&c("slideHorizontal",e);0!==e.moveY&&c("slideVertical",e);c("slideAfterMove",e),timer=setTimeout((()=>{i=e}),COMPUTE_INTERVAL)})),document.addEventListener("pointerup",(function(e){clearTimeout(timer),a(e),n&&(c("slideEnd",e),e.velocityX<0&&c("slideRightEnd",e),e.velocityY<0&&c("slideBottomEnd",e),e.velocityX>0&&c("slideLeftEnd",e),e.velocityY>0&&c("slideTopEnd",e),0!==e.velocityX&&c("slideHorizontalEnd",e),0!==e.velocityY&&c("slideVerticalEnd",e),c("slideAfterEnd",e));c("slideUp",e),currentView=void 0}));let e,t,i,s,o,n=!1,r=!0,l=[];function a(n){if(l.push(n.pressure),n.srcViews=compute.srcViews,n.currentTime=Date.now(),n.direction=s,n.orientation=o,e&&(n.deltaX=n.pageX-(e?.pageX??0),n.deltaY=n.pageY-(e?.pageY??0),n.deltaC=calcHypotenuse(n.deltaX,n.deltaY),n.deltaAng=calculateAngle(n.deltaX,n.deltaY),t&&(n.moveX=(t?.pageX??0)-n.pageX,n.moveY=(t?.pageY??0)-n.pageY,n.deltaTime=n.currentTime-(t?.currentTime??0),n.speedX=n.moveX/n.deltaTime,n.speedY=n.moveY/n.deltaTime,i&&(n.velocityX=undefinedReturn(i.velocityX,n.speedX),n.velocityY=undefinedReturn(i.velocityY,n.speedY),n.currentTime-i.currentTime>=COMPUTE_INTERVAL)))){let e=1;const t=(i?.pageX??0)-n.pageX,s=(i?.pageY??0)-n.pageY,o=n.currentTime-(i?.currentTime??0);n.velocityX=Number((t/o*e).toFixed(2)),n.velocityY=Number((s/o*e).toFixed(2)),i=n,l=[]}}function c(e,t){if(!currentView)return;const i=inheritPointerEvent(e,t);currentView.dispatchEvent(i),customEventNameMap.forEach((i=>{const s=inheritPointerEvent(e.replace(/(Slide|slide)/,i),t);currentView.dispatchEvent(s)}))}})();class ScrollEvent extends SlideEvent{scrollTop=void 0}function inheritSlideEvent(e,t={},i={bubbles:!0,cancelable:!0}){const s=new ScrollEvent(e,i);for(const e in t)try{void 0===s[e]&&(s[e]=t[e])}catch(e){console.warn(e)}return s}const LOG=(...e)=>console.log(...e);class RNestedScroll extends RainbowElement{static observedAttributes=this.$registerProps({"r-scroll-direction":String});$slotContainer={default:document.createElement("div")};$$={nestedChild:void 0,nestedChildren:[],nestedParent:void 0,setNestedChild:()=>{if(1===this.$$.nestedChildren.length)return void(this.$$.nestedChild=this.$$.nestedChildren[0]);if(!this.$$.nestedChildren.length)return;const e=this.getBoundingClientRect();this.$$.nestedChild=this.$$.nestedChildren.find((t=>{const i=t.getBoundingClientRect();return i.left-e.left>=-1&&i.right<=e.right+1}))},captureOptions:{passive:!1,capture:!0},slideEvent:extendedSlideEvents(this,{}),scrollEvent:setup({scrollEl:this,container:this.$slotContainer.default}),disabledScroll:()=>{},unDisabledScroll:()=>{}};constructor(...e){super(...e)}connectedCallback(...e){super.connectedCallback(...e),this.$.appendChild(this.$slotContainer.default),this.$$.nestedParent=this.$.findParentByLocalName(["r-nested-scroll"]),this.$$.nestedParent&&this.$$.nestedParent.$$.nestedChildren.push(this),this.$$.setNestedChild(),this.$slotContainer.default.classList.add("r-nested-scroll-content"),this.classList.add("r-nested-scroll"),this.$$.slideEvent.bindEvents(),this.$$.scrollEvent.bindEvents()}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.nestedParent&&arrayRemove(this.$$.nestedParent.$$.nestedChildren,this),this.$$.slideEvent.destroy(),this.$$.scrollEvent.destroy()}}function setup(e){const{scrollEl:t,container:i,view:s=t}=e;let o,n;const r=20;let l=()=>t.offsetHeight+Math.ceil(t.scrollTop)>=i.offsetHeight,a=()=>t.scrollTop<=0,c=()=>i.offsetHeight-t.offsetHeight,h=()=>t.offsetWidth+t.scrollLeft>=i.offsetWidth,d=()=>t.scrollLeft<=0,$=()=>i.offsetWidth-t.offsetWidth,u=()=>s.$.findParentByLocalName(["r-nested-scroll"]),v=(e,t="vertical")=>!e.srcViews.every((e=>e.$.DATA.rScrollDirection===t))&&e.orientation!==t;function m(e){v(e,"vertical")||l()||(e.stopPropagation(),E(e.moveY,e))}function p(e){v(e,"vertical")||a()||(e.stopPropagation(),b(e.moveY))}function g(e){v(e,"vertical")||l()||(e.stopPropagation(),C(e.velocityY,e))}function f(e){v(e,"vertical")||a()||(e.stopPropagation(),w(e.velocityY,e))}function b(e,i){let o=t.scrollTop+e;o<0&&(o=0),t.scrollTop=o,s.dispatchEvent(y("scrollDown",i)),s.dispatchEvent(y("scrollChange",i)),a()&&s.dispatchEvent(y("scrollTop",i))}function y(e,s={}){return inheritSlideEvent(e,{...s,scrollTop:t.scrollTop,scrollHeight:t.offsetHeight,containerHeight:i.offsetHeight,space:s?.moveY})}function E(e,i={}){let o=t.scrollTop+e;o>c()&&(o=c()+2),t.scrollTop=o,s.dispatchEvent(y("scrollUp",i)),s.dispatchEvent(y("scrollChange",i)),l()&&s.dispatchEvent(y("scrollBottom",i))}function C(e,t){o?.stop?.(),o=cAni({velocity:e,onanimation(e){const i=Math.ceil(e*r);i>0&&(E(i,t),l()&&(o?.stop?.(),LOG("滚动停止 到底停止"),s.$$.nestedChild?.$$?.scrollEvent?.dispatchScrollTopFlying?.(e,t)))},onanimationEnd(e){LOG("滚动停止 scrollEnd "),s.dispatchEvent(y("scrollEnd",t))}}),o.start()}function w(e,t){o?.stop?.(),o=cAni({velocity:e,onanimation(e){const i=Math.ceil(e*r);i<0&&(b(i,t),a()&&(o?.stop?.(),LOG("滚动停止 到顶部停止"),u()?.$$?.scrollEvent?.dispatchScrollBottomFlying?.(e,t)))},onanimationEnd(e){LOG("滚动停止"),s.dispatchEvent(y("scrollEnd",t))}}),o.start()}function S(e){if("horizontal"!==e.orientation)return;if(h())return;e.stopPropagation();let i=t.scrollLeft+e.moveX;i>$()&&(i=$()+2),t.scrollLeft=i,s.$$.setNestedChild()}function L(e){if("horizontal"!==e.orientation)return;if(d())return;e.stopPropagation();let i=t.scrollLeft+e.moveX;i<0&&(i=0),t.scrollLeft=i,s.$$.setNestedChild()}function x(e){R(e)}function A(e){R(e)}function R(e){if("horizontal"!==e.orientation)return;if(h())return;if(d())return;e.stopPropagation();const i=t.scrollLeft,o=Math.floor(i/t.offsetWidth),r=Math.round(i/t.offsetWidth);let l=r;e.velocityX>.4&&(l=o+1),e.velocityX<-.4&&(l=o),console.log(o,r);const a=t.offsetWidth*l;n=Animation({from:i,to:a,avg:30,onanimation(e){t.scrollLeft=e,s.$$.setNestedChild()},onanimationend(){}}),n.start()}return{bindEvents:function(){const{rScrollDirection:e}=t.$.DATA,i={passive:!0,capture:!1},s={passive:!0,capture:!0};console.log("rScrollDirection",e),"vertical"===e&&(t.addEventListener("slideTop",m,s),t.addEventListener("slideBottom",p,i),t.addEventListener("slideTopEnd",g,s),t.addEventListener("slideBottomEnd",f,i)),"horizontal"===e&&(t.addEventListener("slideLeft",S,i),t.addEventListener("slideRight",L,i),t.addEventListener("slideLeftEnd",x,i),t.addEventListener("slideRightEnd",A,i))},destroy:function(){},dispatchScrollTopFlying:C,dispatchScrollBottomFlying:w}}function cAni(e={}){let t;const i={velocity:0,deceleration:.04,onanimation:()=>{},onanimationEnd:()=>{},...e};let s=!1;const o=i.velocity<0;function n(){if(s)return cancelAnimationFrame(t);t=requestAnimationFrame((()=>s?cancelAnimationFrame(t):(i.velocity=Number((i.velocity+i.deceleration).toFixed(3)),i.velocity>0&&(i.velocity=0),i.velocity>=0?(a(),void i.onanimationEnd(i.velocity)):s?cancelAnimationFrame(t):(i.onanimation(i.velocity),void n()))))}function r(){if(s)return cancelAnimationFrame(t);t=requestAnimationFrame((()=>s?cancelAnimationFrame(t):(i.velocity=Number((i.velocity-i.deceleration).toFixed(3)),i.velocity<0&&(i.velocity=0),i.velocity<=0?(a(),void i.onanimationEnd(i.velocity)):s?cancelAnimationFrame(t):(i.onanimation(i.velocity),void r()))))}function l(){o?n():r()}function a(){s=!0,cancelAnimationFrame(t)}return{start:function(){s=!1,l()},stop:a}}function Animation(e={}){let t,i=!1;const s={from:0,to:300,avg:10,duration:500,onanimationend:()=>{},onanimation:()=>{},...e};let o=s.from;function n(){i=!0,cancelAnimationFrame(t)}return{start:function e(){if(i)return cancelAnimationFrame(t);t=requestAnimationFrame((()=>{if(i)return cancelAnimationFrame(t);(s.from<s.to&&(o+=s.avg,o>=s.to&&(o=s.to),s.onanimation(o),o>=s.to)||s.from>s.to&&(o-=s.avg,o<=s.to&&(o=s.to),s.onanimation(o),o<=s.to))&&(s.onanimationend(o),n()),e()}))},stop:n}}class RRefresh extends RainbowElement{static observedAttributes=this.$registerProps({"r-refresh-heignt":{type:String,default:"0"},"r-max-refresh-heignt":{type:String,default:"0"},"r-min-time":{type:String,default:"500"}});onrefresh(){}$$renderRefresh(){const e=document.createElement("r-circle");e.classList.add("r-scroll-refresh-circle");const t=document.createElement("i");t.classList.add("loading-icon","iconfont","r-scroll-refresh-loading"),t.innerHTML="&#xe607;";const i=document.createElement("div");i.classList.add("r-scroll-refresh-text"),this.$.append(e),this.$.append(t),this.$.append(i);const s=()=>{this.$$.loading?(t.classList.remove("r-scroll-refresh-loading-hide"),e.classList.add("r-scroll-refresh-circle-hide")):(t.classList.add("r-scroll-refresh-loading-hide"),e.classList.remove("r-scroll-refresh-circle-hide"))};return s(),()=>{s();const{rRefreshHeignt:t}=this.$.DATA;e.value=this.$$.height/t*100,i.innerText=(()=>this.$$.loading?"正在刷新":this.$$.release?"释放刷新":"下拉刷新")()}}$$={createPromise:()=>new Promise((e=>{this.$$.resolve=e})),resolve:()=>0,promise:void 0,scrollView:createElement("div"),loading:!1,DATA:this.$.DATA,get release(){const{rRefreshHeignt:e}=this.DATA;return this.height>e},render:()=>{},pointerdownEvent:void 0,touchstartEvent:void 0,lock:!1,height:0,pointerdown:e=>{!0!==this.$$.loading&&(this.$$.pointerdownEvent=e,this.$$.lock=!1)},pointermove:e=>{if(!0===this.$$.loading)return;const t=e.pageY-this.$$.pointerdownEvent.pageY,{scrollView:i}=this.$$;if(i.scrollTop>0)return i.removeEventListener("pointermove",this.$$.pointermove),void(this.$$.lock=!1);t>=8&&i.scrollTop<=0&&(this.$$.lock=!0)},touchstart:e=>{!0!==this.$$.loading&&(this.$$.touchstartEvent=e.touches[0])},touchmove:e=>{if(!0===this.$$.loading)return;if(!this.$$.lock)return;const{rMaxRefreshHeignt:t}=this.$.DATA;let i=e.touches[0].pageY-this.$$.touchstartEvent.pageY;e.stopImmediatePropagation(),e.preventDefault(),i<0&&(i=0),this.classList.remove("r-scroll-refresh-transition"),this.$$.height=i/(t/2+i)*t,e.refreshHeight=this.$$.height,this.style.height=this.$$.height+"px",this.$$.render()},touchend:async e=>{if(!0===this.$$.loading)return;if(!this.$$.lock)return;const{scrollView:t}=this.$$,{rRefreshHeignt:i,rMinTime:s}=this.$.DATA;this.classList.add("r-scroll-refresh-transition");const o=this.$$.release;this.$$.height=o?i:0,this.$$.lock=!1,e.refreshHeight=this.$$.height,this.style.height=this.$$.height+"px",this.$$.render(),o&&(this.$$.loading=!0,this.$$.render(),t.$$.disabledScroll(),this.$$.promise=this.$$.createPromise(),e.resolve=this.$$.resolve,this.dispatchEvent(createCustomEvent("refresh",e)),await Promise.allSettled([setTimeoutPromise(s,!0),this.onrefresh(),this.$$.promise].filter(Boolean)),this.$$.height=0,e.refreshHeight=this.$$.height,this.$$.loading=!1,this.style.height=this.$$.height+"px",this.$$.render(),t.$$.unDisabledScroll())},bindEvents:e=>{this.$$.scrollView=e;const t={passive:!1,capture:!0};e.addEventListener("pointerdown",this.$$.pointerdown,t),e.addEventListener("pointermove",this.$$.pointermove,t),e.addEventListener("touchstart",this.$$.touchstart),e.addEventListener("touchmove",this.$$.touchmove),e.addEventListener("touchend",this.$$.touchend),this.$$.render=this.$$renderRefresh()},unbindEvents:()=>{const{scrollView:e}=this.$$;e.removeEventListener("pointerdown",this.$$.pointerdown),e.removeEventListener("pointermove",this.$$.pointermove),e.removeEventListener("touchstart",this.$$.touchstart),e.removeEventListener("touchmove",this.$$.touchmove),e.removeEventListener("touchend",this.$$.touchend)}};constructor(...e){super(...e)}connectedCallback(...e){super.connectedCallback(...e)}disconnectedCallback(...e){super.disconnectedCallback(...e)}}class RScroll extends RainbowElement{$$={refreshView:void 0,prveScrollTop:0,onScroll:e=>{e.scrollTop=this.scrollTop,e.moveY=this.$$.prveScrollTop-this.scrollTop,e.moveY<0&&this.dispatchEvent(createCustomEvent("scrollUp",e)),e.moveY>0&&this.dispatchEvent(createCustomEvent("scrollDown",e)),this.$$.prveScrollTop=this.scrollTop},disabledScroll:()=>{this.classList.add("r-scroll-disabled")},unDisabledScroll:()=>{this.classList.remove("r-scroll-disabled")}};constructor(...e){super(...e),this.addEventListener("scroll",this.$$.onScroll)}connectedCallback(...e){super.connectedCallback(...e),this.$$.refreshView=this.$.findParentByLocalName("r-refresh"),this.$$.refreshView?.$$?.bindEvents?.(this)}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.refreshView?.$$?.unbindEvents?.()}}class RScrollRefresh extends RainbowElement{static observedAttributes=this.$registerProps({"r-refresh-heignt":{type:String,default:"0"},"r-max-refresh-heignt":{type:String,default:"0"},"r-min-time":{type:String,default:"500"}});onrefresh(){}$$renderRefresh(){const e=document.createElement("r-circle");e.classList.add("r-scroll-refresh-circle");const t=document.createElement("i");t.classList.add("loading-icon","iconfont","r-scroll-refresh-loading"),t.innerHTML="&#xe607;";const i=document.createElement("div");i.classList.add("r-scroll-refresh-text"),this.$.append(e),this.$.append(t),this.$.append(i);const s=()=>{this.$$.loading?(t.classList.remove("r-scroll-refresh-loading-hide"),e.classList.add("r-scroll-refresh-circle-hide")):(t.classList.add("r-scroll-refresh-loading-hide"),e.classList.remove("r-scroll-refresh-circle-hide"))};return s(),()=>{s();const{rRefreshHeignt:t}=this.$.DATA;e.value=this.$$.height/t*100,i.innerText=(()=>this.$$.loading?"正在刷新":this.$$.release?"释放刷新":"下拉刷新")()}}$$={createPromise:()=>new Promise((e=>{this.$$.resolve=e})),resolve:()=>0,promise:void 0,scrollParent:void 0,loading:!1,DATA:this.$.DATA,get release(){const{rRefreshHeignt:e}=this.DATA;return this.height>e},render:()=>{},pointerdownEvent:void 0,touchstartEvent:void 0,lock:!1,height:0,pointerdown:e=>{!0!==this.$$.loading&&(this.$$.pointerdownEvent=e,this.$$.lock=!1)},pointermove:e=>{if(!0===this.$$.loading)return;const t=e.pageY-this.$$.pointerdownEvent.pageY,{scrollParent:i}=this.$$;if(i.scrollTop>0)return i.removeEventListener("pointermove",this.$$.pointermove),void(this.$$.lock=!1);t>=8&&i.scrollTop<=0&&(this.$$.lock=!0)},touchstart:e=>{!0!==this.$$.loading&&(this.$$.touchstartEvent=e.touches[0])},touchmove:e=>{if(!0===this.$$.loading)return;if(!this.$$.lock)return;const{rMaxRefreshHeignt:t}=this.$.DATA;let i=e.touches[0].pageY-this.$$.touchstartEvent.pageY;e.stopImmediatePropagation(),e.preventDefault(),i<0&&(i=0),this.classList.remove("r-scroll-refresh-transition"),this.$$.height=i/(t/2+i)*t,e.refreshHeight=this.$$.height,this.style.height=this.$$.height+"px",this.$$.render()},touchend:async e=>{if(!0===this.$$.loading)return;if(!this.$$.lock)return;const{scrollParent:t}=this.$$,{rRefreshHeignt:i,rMinTime:s}=this.$.DATA;this.classList.add("r-scroll-refresh-transition");const o=this.$$.release;this.$$.height=o?i:0,this.$$.lock=!1,e.refreshHeight=this.$$.height,this.style.height=this.$$.height+"px",this.$$.render(),o&&(this.$$.loading=!0,this.$$.render(),t.$$.disabledScroll(),this.$$.promise=this.$$.createPromise(),e.resolve=this.$$.resolve,this.dispatchEvent(createCustomEvent("refresh",e)),await Promise.allSettled([setTimeoutPromise(s,!0),this.onrefresh(),this.$$.promise].filter(Boolean)),this.$$.height=0,e.refreshHeight=this.$$.height,this.$$.loading=!1,this.style.height=this.$$.height+"px",this.$$.render(),t.$$.unDisabledScroll())}};constructor(...e){super(...e)}connectedCallback(...e){super.connectedCallback(...e),this.classList.add("r-scroll-refresh"),this.$$.scrollParent=this.$.findParentByLocalName(["r-scroll","r-scroll-view","r-nested-scroll"]);const{scrollParent:t}=this.$$,i={passive:!1,capture:!0};t.addEventListener("pointerdown",this.$$.pointerdown,i),t.addEventListener("pointermove",this.$$.pointermove,i),t.addEventListener("touchstart",this.$$.touchstart),t.addEventListener("touchmove",this.$$.touchmove),t.addEventListener("touchend",this.$$.touchend),this.$$.render=this.$$renderRefresh()}disconnectedCallback(...e){super.disconnectedCallback(...e);const{scrollParent:t}=this.$$;t.removeEventListener("pointerdown",this.$$.pointerdown),t.removeEventListener("pointermove",this.$$.pointermove),t.removeEventListener("touchstart",this.$$.touchstart),t.removeEventListener("touchmove",this.$$.touchmove),t.removeEventListener("touchend",this.$$.touchend)}}class RScrollMemoryBubble extends RainbowElement{static observedAttributes=this.$registerProps({"r-orientation":{type:String,default:"right"},"r-init-visibility":{type:String,default:"visible"},"r-visible-distance":{type:String,default:"100px"},"r-visible-reversal":String});$$visible=!0;$$cacheMoveY=0;$$scrollParent;connectedCallback(...e){super.connectedCallback(...e),this.$$visible="visible"===this.$.DATA.rInitVisibility,this.$$scrollParent=this.$.findParentByType("RScroll"),this.$$scrollParent.addEventListener("scrollUp",this.$$setVisibleFalse.bind(this)),this.$$scrollParent.addEventListener("scrollDown",this.$$setVisibleTrue.bind(this))}disconnectedCallback(...e){super.connectedCallback(...e),this.$$scrollParent.removeEventListener("scrollUp",this.$$setVisibleFalse.bind(this)),this.$$scrollParent.removeEventListener("scrollDown",this.$$setVisibleTrue.bind(this))}$$setClass(){const{rOrientation:e}=this.$.DATA;this.$.setClass((()=>["r-scroll-memory-bubble-"+e,this.$$visible?"r-scroll-memory-bubble-visible":"r-scroll-memory-bubble-hide",this.$$visible?`r-scroll-memory-bubble-visible-${e}`:`r-scroll-memory-bubble-hide-${e}`]))}$$setVisibleTrue(e){if(!0===this.$$visible)return this.$$cacheMoveY=0;this.$$cacheMoveY=this.$$cacheMoveY+Math.abs(e.moveY),this.$$cacheMoveY>=this.$.DATA.rVisibleDistance&&(this.$$cacheMoveY=0,this.$$visible=!0,this.$$setClass())}$$setVisibleFalse(e){if(!1===this.$$visible)return this.$$cacheMoveY=0;this.$$cacheMoveY=this.$$cacheMoveY+Math.abs(e.moveY),this.$$cacheMoveY>=this.$.DATA.rVisibleDistance&&(this.$$cacheMoveY=0,this.$$visible=!1,this.$$setClass())}$render(){this.$$setClass()}}class RScrollSticky extends RainbowElement{static observedAttributes=this.$registerProps({top:Number,bottom:Number,"r-active-top":Number,"r-active-bottom":Number,"r-scroll-anima":Number,"r-opacity-ani":Boolean,"r-opacity-top":Number,"r-visible-ani":Boolean,"r-visible-top":Number,"r-opacity-delay":Number});$$={class:this.$$onGetClass(),top:{isSticky:!1,isStickyTop:!1,isStickyBottom:!1,isStickyAct:!1},bottom:{isSticky:!1,isStickyTop:!1,isStickyBottom:!1,isStickyAct:!1},scrollParent:document.createElement("div"),onScroll:e=>{let{scrollTop:t}=e;const i=this.$.getOffsetTop(this);this.$$.stickyBottom(t,i),this.$$.stickyTop(t,i)},stickyTop:(e,t)=>{const{top:i,rActiveTop:s}=this.$.DATA;let o=t-e;Math.abs(o-i)<.5&&(o=i),this.$$.top.isSticky=i===o,this.$$.top.isStickyTop=i>=o,this.$$.top.isStickyBottom=i<=o,this.$$.top.isStickyAct=e>=s;const{isSticky:n,isStickyAct:r,isStickyTop:l,isStickyBottom:a}=this.$$.top,c=this.$$.class.top;toggleClass(this,n,c.isSticky,c.unSticky),toggleClass(this,r,c.isStickyAct,c.unStickyAct),toggleClass(this,l,c.isStickyTop,c.unStickyTop),toggleClass(this,a,c.isStickyBottom,c.unStickyBottom)},stickyBottom:(e,t)=>{const{bottom:i,rActiveBottom:s}=this.$.DATA;let o=t-e,n=Math.round(this.$$.scrollParent.offsetHeight-i-this.offsetHeight);Math.abs(o-n)<.8&&(o=n),this.$$.bottom.isSticky=n===o;const{isSticky:r,isStickyAct:l,isStickyTop:a,isStickyBottom:c}=this.$$.bottom,h=this.$$.class.bottom;toggleClass(this,r,h.isSticky,h.unSticky)}};$$onGetClass(){return{top:{isSticky:"r-scroll-sticky-sticky-top",unSticky:"r-scroll-sticky-unsticky-top",isStickyAct:"r-scroll-sticky-act-top",unStickyAct:"r-scroll-sticky-unact-top",isStickyTop:"r-scroll-sticky-top-top",unStickyTop:"r-scroll-sticky-untop-top",isStickyBottom:"r-scroll-sticky-bottom-top",unStickyBottom:"r-scroll-sticky-unbottom-top"},bottom:{isSticky:"r-scroll-sticky-sticky-bottom",unSticky:"r-scroll-sticky-unsticky-bottom"}}}$render(){console.log(this.$.data),this.$$.onScroll({scrollTop:this.$$.scrollParent.scrollTop})}connectedCallback(...e){super.connectedCallback(...e),this.$$.scrollParent=this.$.findParentByLocalName(["r-scroll","r-scroll-view","r-nested-scroll"]),this.$$.scrollParent.addEventListener("scroll",this.$$.onScroll.bind(this))}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.scrollParent.removeEventListener("scroll",this.$$.onScroll.bind(this))}}class RScrollFixed extends RScrollSticky{$$onGetClass(){return{top:{isSticky:"r-scroll-fixed-fixed-top",unSticky:"r-scroll-fixed-unfixed-top",isStickyAct:"r-scroll-fixed-act-top",unStickyAct:"r-scroll-fixed-unact-top",isStickyTop:"r-scroll-fixed-top-top",unStickyTop:"r-scroll-fixed-untop-top",isStickyBottom:"r-scroll-fixed-bottom-top",unStickyBottom:"r-scroll-fixed-unbottom-top"},bottom:{isSticky:"r-scroll-fixed-fixed-bottom",unSticky:"r-scroll-fixed-unfixed-bottom"}}}}class RScrollView extends RainbowElement{static observedAttributes=this.$registerProps({"r-element-style":String,"r-container-style":String});$$={top:createSlot("slot","r-scroll-top"),container:createElement("div","r-scroll-container"),default:createElement("div","r-scroll-element"),defaultSlot:createSlot("slot","r-scroll-element-slot",""),prveScrollTop:0,onScroll:e=>{e.scrollTop=this.$$.default.scrollTop,e.moveY=this.$$.prveScrollTop-this.$$.default.scrollTop,e.moveY<0&&this.dispatchEvent(createCustomEvent("scrollUp",e)),this.onscroll&&this.onscroll(e),this.dispatchEvent(createCustomEvent("scroll",e)),e.moveY>0&&this.dispatchEvent(createCustomEvent("scrollDown",e)),this.$$.prveScrollTop=this.$$.default.scrollTop},disabledScroll:()=>{this.classList.add("r-scroll-view-disabled")},unDisabledScroll:()=>{this.classList.remove("r-scroll-view-disabled")}};get scrollTop(){return this.$$.default?.scrollTop}set scrollTop(e){this.$$.default.scrollTop=e}scrollBy(...e){this.$$.default?.scrollBy?.(...e)}scrollTo(...e){this.$$.default?.scrollTo?.(...e)}constructor(...e){super(...e),this.attachShadow({mode:"open"}),this.$$.default.append(this.$$.defaultSlot),this.$$.container.append(this.$$.default),this.shadowRoot.appendChild(this.$$.top),this.shadowRoot.appendChild(this.$$.container)}connectedCallback(...e){super.connectedCallback(...e),this.$$.default.addEventListener("scroll",this.$$.onScroll),this.$$.prveScrollTop=this.$$.default.scrollTop}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.default.removeEventListener("scroll",this.$$.onScroll)}$render(){const{rElementStyle:e,rContainerStyle:t}=this.$.DATA;this.$$.default.setAttribute("style",e),this.$$.container.setAttribute("style",t)}}class RPulldown extends RainbowElement{$$={value:!1,get dialog(){return document.getElementById("aaa-dialog")},click:()=>{console.log(this.$$.dialog),this.$$.dialog.value=!this.$$.dialog.value}};set value(e){this.$$.value=e,this.$$.dialog.value=e}get value(){return this.$$.value}constructor(...e){super(...e),this.addEventListener("click",this.$$.click)}connectedCallback(...e){super.connectedCallback(...e),console.log(this.$$.dialog)}disconnectedCallback(...e){super.disconnectedCallback(...e)}}class RRollingTextNum extends RainbowElement{static observedAttributes=this.$registerProps({"r-initial-animation":String,"r-transition":String});$$container=document.createElement("span");$$measure=document.createElement("span");$$rotes=arrayLoopMap(10,(()=>document.createElement("span")));$$num=10;$$value=0;$$isMonted=!1;get $$deg(){return 360/this.$$num}get value(){return this.$$value}set value(e){this.$$value=e,console.log("set ------ value",e),this.$$rotateX(!0),console.log("set value",e)}$$renderNums(){const e=this.$$deg,t=(Math.sin(Math.PI/180*e)+.9)*(this.$$measure.offsetHeight||1);this.$$rotes.forEach(((i,s)=>{i.style.transform=`rotateX(${e*s}deg)  translateZ(${t}px)`,i.setAttribute("part","r-rolling-num-rotate"),i.className="r-rolling-num-rotate",i.innerText=s,this.$$container.appendChild(i)}))}async $$rotateX(e){const{rTransition:t,rInitialAnimation:i}=this.$.DATA,s=-this.$$value/this.$$num*360;let o=-Math.round((s-180)%360/36);this.$$rotes.forEach(((e,t)=>{let i="r-rolling-num-rotate";o===t&&(i="r-rolling-num-rotate r-rolling-num-rotate-unact"),(o-1<0?9:o-1)===t&&(i="r-rolling-num-rotate r-rolling-num-rotate-unprve"),(o+1>9?0:o+1)===t&&(i="r-rolling-num-rotate r-rolling-num-rotate-unnext"),e.setAttribute("part",i),e.className=i})),this.$$container.style.transition=t,this.$$container.style.transform=`rotateX(${s}deg)`}connectedCallback(...e){super.connectedCallback(...e);const{rTransition:t,rInitialAnimation:i}=this.$.DATA;this.$$container.className="r-rolling-num-container r-rolling-num-container-ani",this.$$container.setAttribute("part","r-rolling-num-container r-rolling-num-container-ani "),this.$$measure.className="r-rolling-num-measure",this.$$measure.setAttribute("part","r-rolling-num-measure"),this.$$measure.innerText="9",this.$$container.appendChild(this.$$measure),this.appendChild(this.$$container),this.$$renderNums(),this.$$rotateX("true"===i),this.$$isMonted=!0}disconnectedCallback(...e){super.connectedCallback(...e)}}class RRollingText extends RainbowElement{static observedAttributes=this.$registerProps({"r-math-type":String});$$renderNumNodes=renderChildren({parentNode:this});$$={value:""};get value(){return this.$$.value}set value(e){this.$$.value=e,this.$debouncedRender()}$render(){let{rMathType:e}=this.$.DATA,t=this.value,i=arrayLoopMap(String(t).length,(i=>{const s=Number([1,...arrayLoopMap(i,(()=>0))].join(""));return"floor"===e?Math.floor(t/s):t/s}));this.$$renderNumNodes.renderList(i,{keyExtractor:(e,t)=>t,onCreateNode:(e,t,i)=>{let s=document.createElement("r-rolling-text-num");return s.setAttribute("key",i),s.value=e,s},onCacheNode:(e,t,i,s)=>(e.value=t,e.setAttribute("key",s),e)})}}class RCircle extends RainbowElement{static observedAttributes=this.$registerProps({"r-start-angle":String,"r-outer-radius":String,"r-inner-radius":String,"r-origin-x":String,"r-origin-y":String,"r-stroke-width":String,"r-layer-stroke-width":String,"r-direction":String,"r-range-max":String,"r-range-min":String});$onRegisterIMPS(){return[resizeObserverIMP()]}$$={defaultSlot:createSlot("slot","content","content"),default:createElement("div","r-circle-content"),borderDiv:createElement("div","r-circle-border"),layerDiv:createElement("div","r-circle-layer"),value:0,toRadians:e=>e*Math.PI/180,getAngleDiff:(e,t)=>{if(t===e)return 0;let i=(t-e+360)%360;return 0===i?360:i},clockwise:{anglePosition:(e,t,i,s)=>{const o=this.$$.toRadians(e);return{angle:o,x:t+s*Math.cos(o),y:i+s*Math.sin(o)}},arcTo:(e,t,i,s,o,n=!1)=>{o!==s&&(o-s+360)%360==0&&(o-=.001);const r=this.$$.clockwise.anglePosition(s,e,t,i),l=this.$$.clockwise.anglePosition(o,e,t,i),a=this.$$.getAngleDiff(s,o)>180?1:0;return n?{start:l,end:r,largeArcFlag:a,sweepFlag:0}:{start:r,end:l,largeArcFlag:a,sweepFlag:1}}},anticlockwise:{anglePosition:(e,t,i,s)=>{const o=this.$$.toRadians(e);return{angle:o,x:t+s*Math.sin(o),y:i+s*Math.cos(o)}},arcTo:(e,t,i,s,o,n=!1)=>{o!==s&&(o-s+360)%360==0&&(o-=.001);const r=this.$$.anticlockwise.anglePosition(s,e,t,i),l=this.$$.anticlockwise.anglePosition(o,e,t,i),a=this.$$.getAngleDiff(s,o)>180?1:0;return n?{start:l,end:r,largeArcFlag:a,sweepFlag:1}:{start:r,end:l,largeArcFlag:a,sweepFlag:0}}},arcTo:(e,t,i,s,o,n,r)=>r?this.$$[r].arcTo(e,t,i,s,o,n):this.$$.clockwise.arcTo(e,t,i,s,o,n),getRangeValue:(e,t)=>{if("string"==typeof this.value&&/\d+?%/.test(this.value))return parseInt(this.value.replace(/%/,""),10)/100*360;if("number"!=typeof e||"number"!=typeof t)return this.value;let i=this.value;return this.value<e&&(i=e),this.value>t&&(i=t),i/(t-e)*360},getAnnulusPath:(e,t,i,s,o,n,r)=>{const l=this.$$.arcTo(e,t,i,o,n,!1,r),a=this.$$.arcTo(e,t,s,o,n,!0,r);return`path('${[`M ${l.start.x} ${l.start.y}`,`A ${i} ${i} 0 ${l.largeArcFlag} ${l.sweepFlag} ${l.end.x} ${l.end.y}`,`L ${a.start.x} ${a.start.y}`,`A ${s} ${s} 0 ${a.largeArcFlag} ${a.sweepFlag} ${a.end.x} ${a.end.y}`,`L ${l.start.x} ${l.start.y}`,"Z"].join(" ")}')`},getcirclePath:(e,t,i,s,o,n)=>{const r=this.$$.arcTo(e,t,i,s,o,!1,n);return`path('${[`M ${r.start.x} ${r.start.y}`,`A ${i} ${i} 0 ${r.largeArcFlag} ${r.sweepFlag} ${r.end.x} ${r.end.y}`,"Z"].join(" ")}')`}};get value(){return this.$$.value}set value(e){this.$$.value=e,this.$debouncedRender()}connectedCallback(...e){super.connectedCallback(...e),this.attachShadow({mode:"open"}),this.$$.default.appendChild(this.$$.defaultSlot),this.shadowRoot.append(this.$$.layerDiv),this.shadowRoot.append(this.$$.borderDiv),this.shadowRoot.append(this.$$.default)}$render(){let{rStartAngle:e,rOuterRadius:t,rInnerRadius:i,rOriginX:s,rOriginY:o,rStrokeWidth:n,rDirection:r,rLayerStrokeWidth:l,rRangeMin:a,rRangeMax:c}=this.$.DATA;"auto"===t&&(t=Math.min(this.offsetHeight,this.offsetWidth)/2),"auto"===i&&(i=t),t||(t=0),i||(i=0),s=this.$.resolvePercentum(s),o=this.$.resolvePercentumH(o),this.$$.borderDiv.style.clipPath=this.$$.getAnnulusPath(s,o,t-l,i-n-l,e,e+this.$$.getRangeValue(a,c),r),this.$$.layerDiv.style.clipPath=this.$$.getAnnulusPath(s,o,t,i-l-n-l,e,e+360,r),this.$$.default.style.clipPath=this.$$.getcirclePath(s,o,i-l-n-l,e,e+360,r)}}class RSvgCircle extends RainbowElement{static observedAttributes=this.$registerProps({"r-start-angle":String,"r-outer-radius":String,"r-inner-radius":String,"r-origin-x":String,"r-origin-y":String});$onRegisterIMPS(){return[resizeObserverIMP()]}$$={value:0};get value(){return this.$$.value}set value(e){this.$$.value=e,this.$debouncedRender()}$render(){}}class RTestD extends RainbowElement{$$={value:""};set value(e){this.$$.value=e,this.innerText=e}get value(){return this.$$.value}}class RScrollVirtualGridList extends RainbowElement{static observedAttributes=this.$registerProps({"r-columns":{type:Number,default:1},"r-min-auto-width":Number,"r-gap":[Number,String],"r-row-gap":[Number,String],"r-column-gap":[Number,String],"r-avg-height":[Number,String]});keyExtractor=e=>e.item;get $$columns(){let{rColumns:e,rMinAutoWidth:t}=this.$.DATA;return t?Math.floor(this.offsetWidth/t):e}$$={renderChildren:renderChildren({parentNode:this}),value:[],cache:{end:0,start:0},visible:{end:0,start:0},recycle:{divs:[]},createElement:()=>{let e=this.$$.recycle.divs.shift();return e||document.createElement("div")},scrollParent:void 0,onScroll:e=>{this.$$.layout(!1)},layout:(e=!0)=>{if(!this.$$.scrollParent)return;const{rAvgHeight:t,rGap:i,rColumnGap:s,rRowGap:o}=this.$.DATA,n=s||i||0,r=o||i||0,l=this.$.getOffsetTop(this),a=this.$$.scrollParent.scrollTop;let c=Math.ceil(window.innerHeight/(t+n))*this.$$columns,h=Math.floor((a-l)/(t+n))*this.$$columns,d=h-c,$=d<0?0:d;this.$$.visible.start=h<0?0:h,this.$$.visible.end=h+c;let u=d+3*c;u<0&&(u=0);let v=this.value.slice($,u).map(((e,t)=>({index:$+t,item:e,data:e}))),m=!(this.$$.cache.start===$&&this.$$.cache.end===u);this.$$.cache.start=$,this.$$.cache.end=u,this.style.height=(t+n)*Math.ceil(this.value.length/this.$$columns)-n+"px",!1===e&&!1===m||this.$$.renderChildren.renderList(v,{keyExtractor:this.keyExtractor,onCreateNode:(e,i,s)=>{let o=this.$$.createElement();return o.setAttribute("key",s),o.classList.add("r-scroll-virtual-grid-list-item"),o.style.height=`${t}px`,o.style.position="absolute",this.$$.measure(o,e,t,r,n),this.dispatchEvent(createCustomEvent("renderList",{ele:o,...e,key:s})),o},onCacheNode:(e,i,s,o)=>(e.setAttribute("key",o),this.$$.measure(e,i,t,r,n),this.dispatchEvent(createCustomEvent("renderList",{ele:e,...i,key:o})),e),onRemoveNode:(e,t)=>{e.setAttribute("key",""),e.classList.remove("r-scroll-virtual-grid-list-item"),this.$$.recycle.divs.push(e)}})},measure:(e,t,i,s,o)=>{let n=this.$$columns,r=t.index%n,l=Math.floor(t.index/n);e.style.width=`calc( ${100/n}% - ${(n-1)*o/n}px )`,e.style.left=`calc( ${100/n*r}% - ${(n-1)*o/n*r}px + ${r*o}px )`,e.style.top=l*(i+s)+"px"},onValueChange:()=>{this.$$.layout()}};set value(e){e instanceof ListArray?(e.removeEventListener("change",this.$$.onValueChange),e.addEventListener("change",this.$$.onValueChange)):arrayRewriteFunction(e,(()=>this.$$.layout())),this.$$.value=e,this.$$.layout()}get value(){return this.$$.value}connectedCallback(...e){super.connectedCallback(...e),this.$$.scrollParent=this.$.findParentByLocalName(["r-scroll","r-scroll-view","r-nested-scroll"]),this.$$.scrollParent.addEventListener("scroll",this.$$.onScroll.bind(this)),this.$$.layout()}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.scrollParent.removeEventListener("scroll",this.$$.onScroll.bind(this))}$render(){this.$$.layout()}}class ItemCache{list=[];width=void 0;height=void 0;left=void 0;top=void 0;vTop=void 0;bottom=void 0;vBottom=void 0}class RScrollVirtualFallsList extends RainbowElement{static observedAttributes=this.$registerProps({"r-columns":{type:Number,default:1},"r-min-auto-width":Number,"r-gap":[Number,String],"r-row-gap":[Number,String],"r-column-gap":[Number,String],"r-avg-height":[Number,String]});keyExtractor=e=>e.item;get $$columns(){let{rColumns:e,rMinAutoWidth:t}=this.$.DATA;return t?Math.floor(this.offsetWidth/t):e}$$={resizeObserver:new ResizeObserver((e=>{e.forEach((e=>{const t=getBoundingClientRect(e.target);e.target?.__bindData__?.__cache__&&(e.target.__bindData__.__cache__.height=t.height)})),this.$$.layout()})),renderChildren:renderChildren({parentNode:this}),value:[],preLoadIndex:0,cache:{start:void 0,end:void 0},createElement:()=>{let e=document.createElement("div");return this.$$.resizeObserver.observe(e),e},scrollParent:void 0,onScroll:e=>{this.$$.layout(!1)},findIndex:e=>arrayBinaryFindIndex(this.value,(t=>!!t.__cache__&&(t.__cache__.vTop<=e&&e<=t.__cache__.vBottom)),(t=>!!t.__cache__&&t.__cache__.vTop<e)),falls:{list:[]},getCssValues:()=>{const{rAvgHeight:e,rGap:t,rColumnGap:i,rRowGap:s}=this.$.DATA,o=i||t||0,n=s||t||0,r=this.$.getOffsetTop(this),l=-window.innerHeight+r,a=2*window.innerHeight+r;return{scrollTop:this.$$.scrollParent.scrollTop,recycleBottom:a,recycleTop:l,offsetTop:r,rowGap:n,columnGap:o,rAvgHeight:e}},layout:(e=!0)=>{if(!this.$$.scrollParent)return;const{scrollTop:t,recycleBottom:i,recycleTop:s,rowGap:o}=this.$$.getCssValues();let n=this.$$.findIndex(t);-1===n&&(n=0);let r=n+30;r>this.value.length&&(r=this.value.length);let l=!(this.$$.cache.start===n&&this.$$.cache.end===r);if(this.$$.cache.start=n,this.$$.cache.end=r,this.$$.preLoadIndex=r,!1===e&&!1===l)return;console.log("start",n);let a=this.value[n];if(!a)return;let c=this.value.slice(n,r).map(((e,t)=>({index:n+t,item:e,data:e})));a.__cache__?this.$$.falls.list=a.__cache__.list:this.$$.falls.list=initList.call(this);let h=getMinHeightItem(this.$$.falls.list),d=new ItemCache;this.$$.renderChildren.renderList(c,{keyExtractor:this.keyExtractor,onCreateNode:(e,t,i)=>{let s=this.$$.createElement();return s.setAttribute("key",i),s.classList.add("r-scroll-virtual-falls-list-item"),s.style.position="absolute",this.dispatchEvent(createCustomEvent("renderList",{ele:s,...e,key:i})),s},onCacheNode:(e,t,i,s)=>(e.setAttribute("key",s),this.dispatchEvent(createCustomEvent("renderList",{ele:e,...t,key:s})),e),onBeforeInsertNode:(e,t,i)=>{h=getMinHeightItem(this.$$.falls.list),e.item.__cache__||(e.item.__cache__=new ItemCache),d=e.item.__cache__,d.list=this.$$.falls.list.map((e=>({...e})))},onInsertBeforeNode:(e,t,n,r)=>{h.height&&(h.height=h.height+o),e.style.width=h.width,e.style.left=h.left,e.style.top=h.height+"px";const l=getBoundingClientRect(e);d.height=l.height,d.width=e.offsetWidth,d.top=h.height,d.vTop=h.height+s,d.left=e.style.left,h.height=h.height+l.height,d.bottom=h.height,d.vBottom=h.height+i,d.calculateList=this.$$.falls.list.map((e=>({...e}))),e.__bindData__=t.item},onRemoveNode:(e,t)=>{e.setAttribute("key",""),this.$$.resizeObserver.unobserve(e)}}),this.$$.preLoads(),this.$$.setHeight(),this.$$.backstage.reStart()},setHeight:()=>{const e=this.value.at(-1)?.__cache__?.calculateList;if(e?.length)this.style.height=`${getMaxHeightItem(e).height}px`;else{const{rAvgHeight:e,columnGap:t}=this.$$.getCssValues();this.style.height=(e+t)*Math.ceil(this.value.length/this.$$columns)-t+"px"}},onValueChange:()=>{this.$$.layout()},preLoads:(e=100)=>{let t=this.value.length-this.$$.preLoadIndex;e>t&&(e=t),arrayLoop(e,(()=>{this.$$.preLoad(),this.$$.preLoadIndex++}))},preLoad:()=>{const e=this.value[this.$$.preLoadIndex];if(!e)return;const{scrollTop:t,recycleBottom:i,recycleTop:s,rowGap:o,rAvgHeight:n}=this.$$.getCssValues();let r=new ItemCache;e.__cache__||(e.__cache__=new ItemCache),r=e.__cache__,r.list=this.$$.falls.list.map((e=>({...e})));let l=getMinHeightItem(this.$$.falls.list);r.height||(r.height=n),l.height&&(l.height=l.height+o),r.top=l.height,r.vTop=l.height+s,r.left=l.left,r.width=l.width,l.height=l.height+r.height,r.bottom=l.height,r.vBottom=l.height+i,r.calculateList=this.$$.falls.list.map((e=>({...e})))},backstage:createBackstage((()=>{this.$$.preLoads(50),this.$$.setHeight()}),(()=>this.$$.preLoadIndex>=this.value.length))};set value(e){e instanceof ListArray?(e.removeEventListener("change",this.$$.onValueChange),e.addEventListener("change",this.$$.onValueChange)):arrayRewriteFunction(e,(()=>this.$$.layout())),this.$$.value=e,this.$$.layout()}get value(){return this.$$.value}connectedCallback(...e){super.connectedCallback(...e),this.$$.scrollParent=this.$.findParentByLocalName(["r-scroll","r-scroll-view","r-nested-scroll"]),this.$$.scrollParent.addEventListener("scroll",this.$$.onScroll.bind(this)),this.$$.falls.list=initList.call(this),this.$$.layout()}disconnectedCallback(...e){super.disconnectedCallback(...e),this.$$.scrollParent.removeEventListener("scroll",this.$$.onScroll.bind(this)),this.$$.backstage.stop()}}function initList(){const e=this.$$columns||1,{rAvgHeight:t,rGap:i,rColumnGap:s,rRowGap:o}=this.$.DATA,n=s||i||0;return arrayLoopMap(e,(t=>({width:`calc( ${100/e}% - ${(e-1)*n/e}px )`,left:`calc( ${100/e*t}% - ${(e-1)*n/e*t}px + ${t*n}px )`,height:0,top:0,index:t})))}function getMinHeightItem(e){let t=e[0];return e.forEach((e=>{e.height<t.height&&(t=e)})),t}function getMaxHeightItem(e){let t=e[0];return e.forEach((e=>{e.height>t.height&&(t=e)})),t}function createBackstage(e,t){let i,s=requestIdleCallback||requestAnimationFrame,o=requestIdleCallback?cancelIdleCallback:cancelAnimationFrame;function n(o){l(),t()||o.timeRemaining()>0&&(e(),o.didTimeout||(i=s(n)))}function r(){i=s(n)}function l(){o(i)}return{start:r,stop:l,reStart:function(){l(),r()}}}function getBoundingClientRect(e=document.createElement("div")){let t=e.getBoundingClientRect();return{height:Number(t.height.toFixed(2))}}class RFoldText extends RainbowElement{static observedAttributes=this.$registerProps({"r-max-line":Number});$slotContainer={default:document.createElement("span"),text:document.createElement("span"),end:document.createElement("span"),fold:document.createElement("span"),unfold:document.createElement("span")};$$={value:"",isFold:!1,foldText:"",rowHeight:0,click:()=>{if(!this.$$.foldText)return;const{text:e,default:t,end:i,fold:s,unfold:o}=this.$slotContainer;!0===this.$$.isFold&&(e.innerText=this.value),!1===this.$$.isFold&&(e.innerText=this.$$.foldText),this.$$.isFold=!this.$$.isFold;const n=t.getBoundingClientRect();this.style.height=n.height+"px",this.$$.isFold?(i.classList.add("r-fold-text-end-fold"),i.classList.remove("r-fold-text-end-unfold")):(i.classList.add("r-fold-text-end-unfold"),i.classList.remove("r-fold-text-end-fold"))},setInnerText:(e=0,t=0,i=0)=>{if(++e>this.value.length)return" ";const{text:s,default:o,end:n,fold:r,unfold:l}=this.$slotContainer,a=this.value.slice(0,e);s.innerText=a;const c=o.getBoundingClientRect();return i!==c.height&&(i=c.height,(t+=1)>2)?this.value.slice(0,e-1):this.$$.setInnerText(e,t,i)},draw:(e=0,t=0,i=0)=>{if(++e>this.value.length)return;const{text:s,default:o,end:n,fold:r,unfold:l}=this.$slotContainer,a=this.value.slice(0,e);s.innerText=a;const c=o.getBoundingClientRect();if(i!==c.height){if(i=c.height,(t+=1)>2)return this.style.height=this.rowHeight+"px",n.classList.remove("r-fold-text-end-none"),this.$$.foldText=this.$$.setInnerText(),s.innerText=this.$$.foldText,this.$$.isFold=!0,void(this.$$.isFold?(n.classList.add("r-fold-text-end-fold"),n.classList.remove("r-fold-text-end-unfold")):(n.classList.add("r-fold-text-end-unfold"),n.classList.remove("r-fold-text-end-fold")));this.rowHeight=i}this.$$.draw(e,t,i)}};set value(e){this.$$.value=e,this.$slotContainer.end.classList.add("r-fold-text-end-none"),this.$$.draw()}get value(){return this.$$.value}connectedCallback(...e){console.log("connectedCallback-connectedCallback"),super.connectedCallback(...e),this.addEventListener("click",this.$$.click.bind(this)),this.$slotContainer.default.classList.add("r-fold-text-default"),this.$slotContainer.text.classList.add("r-fold-text-text"),this.$slotContainer.end.classList.add("r-fold-text-end","iconfont"),this.$slotContainer.fold.classList.add("r-fold-text-end-fold-solt"),this.$slotContainer.unfold.classList.add("r-fold-text-end-unfold-solt"),this.$slotContainer.end.innerHTML||(this.$slotContainer.end.innerHTML="&#xe745;&#xe745;&#xe745"),this.$.append(this.$slotContainer.default),this.$slotContainer.default.append(this.$slotContainer.text),this.$slotContainer.default.append(this.$slotContainer.end),this.$slotContainer.default.append(this.$slotContainer.fold),this.$slotContainer.default.append(this.$slotContainer.unfold)}disconnectedCallback(...e){super.disconnectedCallback(...e),this.removeEventListener("click",this.$$.click.bind(this))}}var elements=Object.freeze({__proto__:null,RAbsolute:RAbsolute,RCircle:RCircle,RDialog:RDialog,RFalls:RFalls,RFoldText:RFoldText,RGrid:RGrid,RMove:RMove,RNestedScroll:RNestedScroll,ROverlay:ROverlay,RPulldown:RPulldown,RRefresh:RRefresh,RRollingText:RRollingText,RRollingTextNum:RRollingTextNum,RScroll:RScroll,RScrollFixed:RScrollFixed,RScrollMemoryBubble:RScrollMemoryBubble,RScrollRefresh:RScrollRefresh,RScrollSticky:RScrollSticky,RScrollView:RScrollView,RScrollVirtualFallsList:RScrollVirtualFallsList,RScrollVirtualGridList:RScrollVirtualGridList,RSvgCircle:RSvgCircle,RTestD:RTestD,createDialog:createDialog});function defineElements(){for(const e in elements)if(Object.prototype.hasOwnProperty.call(elements,e)){const t=elements[e],i=e.replaceAll(/[A-Z]/g,(e=>"-"+e.toLowerCase())).slice(1);customElements.define(i,t)}}defineElements();export{RAbsolute,RCircle,RDialog,RFalls,RFoldText,RGrid,RMove,RNestedScroll,ROverlay,RPulldown,RRefresh,RRollingText,RRollingTextNum,RScroll,RScrollFixed,RScrollMemoryBubble,RScrollRefresh,RScrollSticky,RScrollView,RScrollVirtualFallsList,RScrollVirtualGridList,RSvgCircle,RTestD,RainbowElement,RainbowEvent,Transition,assignStyle,camelCaseToKebabCase,convertToCamelCase,createCustomEvent,createDialog,createElement,createSlot,defineElements,deleteKey,isNum,rainbow$1 as rainbow,renderChildren,toggleClass,wipePX};
//# sourceMappingURL=index.js.map
