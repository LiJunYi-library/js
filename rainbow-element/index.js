!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rainbowElement={})}(this,(function(t){"use strict";class e extends HTMLElement{static $initProps(t){const e=[],s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e.push(i),t[i]?.default instanceof Function?s[i]=t[i].default(s):s[i]=t[i]?.default);return this.prototype.$props=t,this.prototype.$attrs=s,e}$ASTProps={};$isASTinit=!1;$childrenResizeObserver;$resizeObserver;$mutationObserver;$mutationObserverInit={childList:!0};$cache={offset:{}};$renderEvents=[];constructor(){super(),this.$initResizeObserver(),this.$initMutationObserver(),this.$initChildrenResizeObserver()}$createCustomEvent(t,e,s={}){const i=new CustomEvent(t,{bubbles:!0,cancelable:!0,...s});for(const t in e)try{void 0===i[t]&&(i[t]=e[t])}catch(t){console.warn(t)}return i}$getParentByType(t,e=this){if(!e)return;const s=e.parentNode;if(!s)return;return s.constructor.name===t?s:this.$getParentByType(t,s)}$dispatchOn(t,...e){this?.[t]?.(...e),this.$renderEvents.includes(t)&&this.$onRender(t,...e)}$initMutationObserver(){try{this.$mutationObserver=new MutationObserver(this.$mutationObserverCB.bind(this)),this.$mutationObserver.observe(this,this.$mutationObserverInit)}catch(t){console.warn(t)}}$mutationObserverCB(t,...e){this.$dispatchOn("$onMutation",t,...e);for(let e of t)if("childList"===e.type){const t=Array.from(e.addedNodes).filter((t=>t.style)),s=Array.from(e.removedNodes).filter((t=>t.style));t.forEach((t=>this.$childrenResizeObserver.observe(t))),s.forEach((t=>this.$childrenResizeObserver.unobserve(t))),this.$dispatchOn("$onChildChange",e)}else"attributes"===e.type&&this.$dispatchOn("$onAttributeChange",e)}$onRender(){}$onMutation(){}$onChildChange(){}$onAttributeChange(){}$initChildrenResizeObserver(){try{this.$childrenResizeObserver=new ResizeObserver(this.$childrenResizeObserverCB.bind(this))}catch(t){console.warn(t)}}$childrenResizeObserverCB(...t){this.$dispatchOn("$onChildrenResize",...t)}$initResizeObserver(){try{this.$resizeObserver=new ResizeObserver(this.$resizeObserverCB.bind(this)),this.$resizeObserver.observe(this)}catch(t){console.warn(t)}}$resizeObserverCB(...t){this.$dispatchOn("$onResizeObserver",...t);const e=this.$cache.offset,s=this?.getBoundingClientRect?.();e.width===s.width&&e.height===s.height||this.$dispatchOn("$onResize",s,...t),e.width!==s.width&&this.$dispatchOn("$onWidthChange",s,...t),e.height!==s.height&&this.$dispatchOn("$onHeightChange",s,...t),this.$cache.offset=s}$onResize(){}$onWidthChange(){}$onHeightChange(){}$setAttrsProp(t,e){const s=this.$props[t];if(!s)return this.$attrs[t]=e;let i=s.type||s;if(i instanceof Array){let t=i.map((t=>t.name));i=t.includes("String")?String:i[0]}let r="true"===e||"false"!==e&&("null"===e?null:"undefined"!==e?i(e):void 0);this.$attrs[t]=r}$onAttrsChange(){}attributeChangedCallback(t,e,s){!1===this.$isASTinit&&(this.$ASTProps[t]=s),this.$attrs[t]=s,this.$setAttrsProp(t,s),!0===this.$isASTinit&&this.$onAttrsChange(this.$attrs,t,e,s)}$onConnected(){}connectedCallback(){this.$isASTinit=!0,Array.from(this.children).forEach((t=>this.$childrenResizeObserver.observe(t))),this.$dispatchOn("$onConnected")}$onAdopted(){}adoptedCallback(){this.$dispatchOn("$onAdopted")}$onDisconnected(){}disconnectedCallback(){this.$resizeObserver?.disconnect?.(),this.$childrenResizeObserver?.disconnect?.(),this.$mutationObserver?.disconnect?.(),this.$dispatchOn("$onDisconnected")}}class s extends e{static observedAttributes=this.$initProps({columns:{type:Number,default:1},gap:[Number,String],"row-gap":[Number,String],"column-gap":[Number,String],inline:Boolean,"min-auto-width":Number,wrap:Boolean,stretch:Boolean,onred:Function});$renderEvents=["$onMutation","$onWidthChange","$onAttrsChange"];get $columns(){return this.$attrs["min-auto-width"]?Math.floor(this.offsetWidth/this.$attrs["min-auto-width"]):this.$attrs.columns}$bindStyle(t){Object.assign(this.style,{display:t.inline?"inline-grid":"grid","grid-template-columns":` repeat(${this.$columns}, 1fr)`,"grid-gap":t.gap+"px","row-gap":(t["row-gap"]||t.gap)+"px","column-gap":(t["column-gap"]||t.gap)+"px"})}$doLayout(){let t=this.$attrs,e=Array.from(this.children),s=e.map((t=>1*t.getAttribute("grid-column")||1)),i=1,r=[],n=this.$columns+1;s.forEach(((e,s)=>{let o=i+e;if(t.wrap){if(o>n){t.stretch&&r[s-1]&&(r[s-1].end=n),i=1;let l=i+e;o=l>n?n:l}}else o>n&&(o=n);r.push({start:i,end:o,index:s}),i+=e,i>this.$columns&&(i=1)})),e.forEach(((t,e)=>{t.classList.add("r-grid-item"),t.style["grid-column-start"]=r[e].start,t.style["grid-column-end"]=r[e].end}))}$onRender(){this.$bindStyle(this.$attrs),this.$doLayout(),this.classList.add("r-grid")}}customElements.define("r-grid",s);class i extends e{static observedAttributes=this.$initProps({position:[Boolean,String],left:[Number,String],right:[Number,String],bottom:[Number,String],top:[Number,String]});$renderEvents=["$onConnected","$onAttrsChange"];$onRender(){let t=this.$attrs;this.classList.add(...["r-absolute",t.position&&"r-absolute-"+t.position].filter(Boolean))}}customElements.define("r-absolute",i),Array.prototype.at||(Array.prototype.at=function(...t){return function(t,e){let s=e<0?t.length+e:e;return t[s]}(this,...t)});class r extends e{static observedAttributes=this.$initProps({"min-auto-width":Number,columns:{type:Number,default:2},gap:{type:Number,default:0},"row-gap":{type:Number,default:0},"column-gap":{type:Number,default:0}});constructor(...t){super(...t)}get $col(){return this.$attrs["min-auto-width"]?Math.floor(this.offsetWidth/this.$attrs["min-auto-width"]):this.$attrs.columns}get $coGap(){return this.$attrs["column-gap"]||this.$attrs.gap}get $roGap(){return this.$attrs["row-gap"]||this.$attrs.gap}get $itemWidth(){return`calc( ${100/this.$col}% - ${(this.$col-1)*this.$coGap/this.$col}px )`}$getLeft(t){return`calc( ${100/this.$col*t}% - ${(this.$col-1)*this.$coGap/this.$col*t}px + ${t*this.$coGap}px )`}$createList(){const t=function(t,e){const s=[];for(let i=0;i<t;i++)s.push(e(i));return s}(this.$col,(t=>({height:0,left:this.$getLeft(t),top:0,index:t})));return t.getMinHeightItem=()=>{let e=t[0];return t.forEach((t=>{t.height<e.height&&(e=t)})),e},t.getMaxHeightItem=()=>{let e=t[0];return t.forEach((t=>{t.height>e.height&&(e=t)})),e},t}$renderEvents=["$onMutation","$onWidthChange","$onChildrenResize","$onAttrsChange"];$onRender(){this.classList.add("r-falls");const t=this.$createList();Array.from(this.children).forEach((e=>{e.classList.add("r-falls-item"),e.style.width=this.$itemWidth;let s=t.getMinHeightItem();s.height&&(s.height=s.height+this.$roGap),e.style.left=s.left,e.style.top=s.height+"px",s.height=s.height+e.offsetHeight})),this.style.height=t.getMaxHeightItem().height+"px"}}customElements.define("r-falls",r);class n extends e{static observedAttributes=this.$initProps({direction:{type:String,default:"row"},inline:Boolean,reverse:Boolean,wrap:Boolean,justify:{type:String,default:""},align:{type:String,default:""},"align-self":{type:String,default:""},auto:{type:[String,Boolean],default:""},fill:{type:[String,Boolean],default:""},gap:{type:[Number,String],default:""},"row-gap":[Number,String],"column-gap":[Number,String]});$renderEvents=["$onConnected","$onAttrsChange"];$onRender(){let t=this.$attrs;this.classList.add(...["r-flex",t.inline&&"r-inline-flex",t.direction&&`r-flex-direction-${t.direction}`,t.reverse&&`r-flex-direction-${t.direction}-reverse`,t.wrap&&"r-flex-wrap",t.justify&&`r-flex-justify-${t.justify}`,t.auto&&`r-flex-justify-auto-${t.auto}`,t.align&&`r-flex-align-${t.align}`,t["align-self"]&&`r-flex-align-self-${t["align-self"]}`,t.fill&&`r-flex-fill-${t.fill}`].filter(Boolean)),Object.assign(this.style,{"grid-gap":t.gap+"px","row-gap":(t["row-gap"]||t.gap)+"px","column-gap":(t["column-gap"]||t.gap)+"px"})}}customElements.define("r-flex",n);class o extends e{constructor(...t){super(...t),this.attachShadow({mode:"open"});const e=document.createElement("div");e.className="r-scroll-content",e.setAttribute("part","r-scroll-content  sdt");const s=document.createElement("slot");s.setAttribute("name","top"),s.className="top";const i=document.createElement("slot");i.className="content";const r=document.createElement("slot");r.setAttribute("name","bottom"),r.className="bottom",e.appendChild(i),this.shadowRoot.appendChild(s),this.shadowRoot.appendChild(e),this.shadowRoot.appendChild(r),this.addEventListener("scroll",this.$onScroll.bind(this))}$prveScrollTop=this.scrollTop;$onScroll(t){t.scrollTop=this.scrollTop,t.moveY=this.$prveScrollTop-this.scrollTop,t.moveY<0&&this.dispatchEvent(this.$createCustomEvent("scrollUp",t)),t.moveY>0&&this.dispatchEvent(this.$createCustomEvent("scrollDown",t)),this.$prveScrollTop=this.scrollTop}$onConnected(){this.classList.add("r-scroll")}$onDisconnected(){this.removeEventListener("scroll",this.$onScroll.bind(this))}}customElements.define("r-scroll",o);class l extends e{static observedAttributes=this.$initProps({top:String,left:String,right:String,bottom:String,position:{type:String,default:"right"},visible:{type:Boolean,default:!0},"visible-distance":{type:Number,default:100},"visible-reversal":Boolean});$visible=!0;$cacheMoveY=0;$scrollParent;$renderEvents=["$onConnected","$onAttrsChange"];$onRender(){this.$bindStyle(),this.$bindClass()}$bindClass(t=this.$attrs){this.className="",this.classList.add(...["r-scroll-memory-bubble","r-scroll-memory-bubble-"+t.position,this.$visible?"r-scroll-memory-bubble-visible":"r-scroll-memory-bubble-hide",this.$visible?`r-scroll-memory-bubble-visible-${t.position}`:`r-scroll-memory-bubble-hide-${t.position}`].filter(Boolean))}$bindStyle(t=this.$attrs){Object.assign(this.style,{top:t.top,right:t.right,bottom:t.bottom,left:t.left})}$onConnected(){this.$visible=this.$attrs.visible,this.$scrollParent=this.$getParentByType("RScroll"),this.$scrollParent.addEventListener("scrollUp",this.$setVisibleFalse.bind(this)),this.$scrollParent.addEventListener("scrollDown",this.$setVisibleTrue.bind(this))}$onDisconnected(){this.$scrollParent.removeEventListener("scrollUp",this.$setVisibleFalse.bind(this)),this.$scrollParent.removeEventListener("scrollDown",this.$setVisibleTrue.bind(this))}$setVisibleTrue(t){if(!0===this.$visible)return this.$cacheMoveY=0;this.$cacheMoveY=this.$cacheMoveY+Math.abs(t.moveY),this.$cacheMoveY>=this.$attrs["visible-distance"]&&(this.$cacheMoveY=0,this.$visible=!0,this.$bindClass())}$setVisibleFalse(t){if(!1===this.$visible)return this.$cacheMoveY=0;this.$cacheMoveY=this.$cacheMoveY+Math.abs(t.moveY),this.$cacheMoveY>=this.$attrs["visible-distance"]&&(this.$cacheMoveY=0,this.$visible=!1,this.$bindClass())}}customElements.define("r-scroll-memory-bable",l),t.RAbsolute=i,t.RFalls=r,t.RFlex=n,t.RGrid=s,t.RScroll=o,t.RScrollMemoryBubble=l,t.RainbowElement=e}));
