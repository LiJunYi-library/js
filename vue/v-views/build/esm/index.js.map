{"version":3,"file":"index.js","sources":["../../src/components/radio-layout/tabs/index.js","../../src/components/scroll-patch/utils.js","../../src/components/scroll-layout/paginationLoading/index.jsx","../../src/components/scroll-layout/virtualGridList/index.vue?vue&type=script&setup=true&lang.jsx","../../src/components/scroll-layout/virtualGridList/index.js","../../src/components/scroll-layout/virtualFallsList/index.vue?vue&type=script&setup=true&lang.jsx","../../src/components/scroll-layout/virtualFallsList/index.js","../../src/components/scroll-patch/virtual-falls-list/index3.jsx","../../src/components/scroll-patch/virtual-grid-list/index.jsx"],"sourcesContent":["import Tabs from \"./index.vue\";\r\nexport const VRTabs = Tabs;\r\n","import { onBeforeUnmount, inject, reactive } from \"vue\";\nimport { arrayRemove, arrayLoopMap } from \"@rainbow_ljy/rainbow-js\";\n\nexport function useScrollController(props = {}) {\n  const RScrollContext = inject(\"RScrollContext\") || {};\n  const controller = reactive({\n    onScrollTop: () => undefined,\n    onScrollBottom: () => undefined,\n    onScrollUp: () => undefined,\n    onScrollDown: () => undefined,\n    onScroll: () => undefined,\n    onScrollend: () => undefined,\n    onScrollRefresh: () => undefined,\n    onScrollRefreshMove: () => undefined,\n    onResize: () => undefined,\n    onMounted: () => undefined,\n    onTouchstart: () => undefined,\n    onTouchend: () => undefined,\n    onFlotage: () => undefined,\n    ...props,\n    destroy,\n    getOffsetTop,\n    dispatchFlotage,\n    context: RScrollContext,\n  });\n\n  RScrollContext?.children?.push?.(controller);\n\n  function getOffsetTop(ele, top = 0) {\n    if (!RScrollContext.element) return top;\n    if (!ele) return top;\n    top = top + ele.offsetTop;\n    if (ele.offsetParent === RScrollContext.element) return top;\n    return getOffsetTop(ele.offsetParent, top);\n  }\n\n  function dispatchFlotage(...arg) {\n    RScrollContext.children.forEach((element) => {\n      element.onFlotage(...arg);\n    });\n  }\n\n  function destroy() {\n    arrayRemove(RScrollContext?.children, controller);\n  }\n\n  onBeforeUnmount(() => {\n    destroy();\n  });\n\n  return controller;\n}\n\nexport function useFallsLayout(options = {}) {\n  const config = { ...options };\n\n  const args = {\n    width: getWidth(),\n    list: undefined,\n    setColumns,\n    afreshConfig,\n    push,\n    layout,\n    setConfig,\n    setWidth,\n    afreshLayout,\n    getMaxHeightItem,\n    getMinHeightItem,\n    setList,\n  };\n\n  setList();\n\n  function setWidth() {\n    args.width = getWidth();\n  }\n\n  function getWidth() {\n    return `calc( ${100 / config.columns}% - ${((config.columns - 1) * config.gap) / config.columns}px )`;\n  }\n\n  function setList() {\n    args.list = getList();\n  }\n\n  function getList() {\n    return arrayLoopMap(config.columns, (i) => ({\n      height: 0,\n      width: args.width,\n      left: getLeft(i),\n      top: 0,\n      children: [],\n      index: i,\n    }));\n  }\n\n  function getColumns(width) {\n    if (!config.minAutoWidth) return config.columns;\n    return Math.floor(width / config.minAutoWidth) || 1;\n  }\n\n  function setColumns(width) {\n    config.columns = getColumns(width);\n    setWidth();\n    setList();\n  }\n\n  function getMaxHeightItem() {\n    let item = args.list[0];\n    args.list.forEach((el) => {\n      if (el.height > item.height) item = el;\n    });\n    return item;\n  }\n\n  function getMinHeightItem(index) {\n    if (typeof index === \"number\") return args.list[index];\n    let item = args.list[0];\n    args.list.forEach((el) => {\n      if (el.height < item.height) item = el;\n    });\n    return item;\n  }\n\n  function setConfig(conf) {\n    Object.assign(config, conf);\n    config.columns = getColumns(conf.width);\n  }\n\n  function afreshConfig(conf) {\n    setConfig(conf);\n    setWidth();\n    setList();\n  }\n\n  function afreshLayout(conf, items = []) {\n    setConfig(conf);\n    setWidth();\n    layout(items);\n  }\n\n  function layout(items = []) {\n    setList();\n    push(...items);\n  }\n\n  function push(...items) {\n    items.forEach((ele) => {\n      if (!ele) return;\n      if (!ele.style) return;\n      let node = getMinHeightItem();\n      if (node.height) node.height = node.height + config.gap;\n      ele.style.left = node.left;\n      ele.style.top = node.height + \"px\";\n      node.height = node.height + ele.offsetHeight;\n    });\n  }\n\n  function remove(...items) {}\n\n  function update(...items) {}\n\n  function getLeft(i) {\n    return `calc( ${(100 / config.columns) * i}% - ${(((config.columns - 1) * config.gap) / config.columns) * i}px + ${i * config.gap}px )`;\n  }\n\n  return args;\n}\n\nexport function arrayBinarySearch(\n  setPointer = (args, index) => (args.right = index - 1),\n  arr = [],\n  formatter,\n  compare,\n) {\n  const fg = {\n    left: 0,\n    right: arr.length - 1,\n    result: -1,\n  };\n  while (fg.left <= fg.right) {\n    const index = Math.floor((fg.left + fg.right) / 2);\n    const item = arr[index];\n    if (formatter(item)) {\n      fg.result = index;\n      setPointer(fg, index, item);\n    } else if (compare(item)) {\n      fg.left = index + 1;\n    } else {\n      fg.right = index - 1;\n    }\n  }\n  return fg.result;\n}\n\nexport function arrayBinaryFindIndex(arr = [], formatter, compare) {\n  return arrayBinarySearch(\n    (args, index) => {\n      args.right = index - 1;\n    },\n    arr,\n    formatter,\n    compare,\n  );\n}\n","import { defineComponent, onUnmounted, onMounted, renderSlot, renderList } from \"vue\";\nimport { findParentByLocalName } from \"@rainbow_ljy/rainbow-element\";\nimport { useScrollController } from \"../../scroll-patch/utils.js\";\nimport \"./index.scss\";\n\nexport const VRPaginationLoading = defineComponent({\n  props: {\n    triggerBottomDistance: { type: Number, default: 500 },\n    loadingHook: { type: Object, default: () => ({}) },\n    onErrorLoadClick: { type: Function },\n    onBeginErrorClick: { type: Function },\n  },\n  emits: [\"rollToBottom\"],\n  setup(props, ctx) {\n    (() => {\n      useScrollController({ onScrollDown });\n      function onScrollDown(event) {\n        const max = event.contentHeight - event.containerHeight - props.triggerBottomDistance;\n        const bool = event.scrollTop >= max;\n        if (bool) ctx.emit(\"rollToBottom\", event);\n      }\n    })();\n    let vm;\n    let scrollView = document.createElement(\"div\");\n    onMounted(mounted);\n    onUnmounted(unmounted);\n\n    function mounted() {\n      const scrollName = [\"r-scroll\", \"r-scroll-view\", \"r-nested-scroll\"];\n      scrollView = findParentByLocalName(scrollName, vm.$el);\n      if (!scrollView) return;\n      scrollView.addEventListener(\"scrollUp\", onScrollUp);\n    }\n\n    function unmounted() {\n      if (!scrollView) return;\n      scrollView.removeEventListener(\"scrollUp\", onScrollUp);\n    }\n\n    function onScrollUp(event) {\n      if (!scrollView) return;\n      const max = scrollView.scrollHeight - scrollView.offsetHeight - props.triggerBottomDistance;\n      const bool = scrollView.scrollTop >= max;\n      if (bool) ctx.emit(\"rollToBottom\", event);\n    }\n\n    function renderLoading() {\n      return renderSlot(ctx.slots, \"loading\", {}, () => [\n        <div class=\"r-pagination-loading-loading\">\n          <div class=\"r-pagination-loading-loading-prve\"></div>\n          <div class=\"r-pagination-loading-loading-text\">加载中</div>\n          <div class=\"r-pagination-loading-loading-next\"></div>\n        </div>,\n      ]);\n    }\n\n    function renderFinished() {\n      return renderSlot(ctx.slots, \"finished\", {}, () => [\n        <div class=\"r-pagination-loading-finished\">\n          <div class=\"r-pagination-loading-finished-prve\"></div>\n          <div class=\"r-pagination-loading-finished-text\">没有更多的了</div>\n          <div class=\"r-pagination-loading-finished-next\"></div>\n        </div>,\n      ]);\n    }\n\n    function renderEmpty() {\n      return renderSlot(ctx.slots, \"empty\", {}, () => [\n        <div class=\"r-pagination-loading-empty\">\n          <div class=\"r-pagination-loading-empty-prve\"></div>\n          <div class=\"r-pagination-loading-empty-text\">暂无相关数据，试试其他条件吧</div>\n          <div class=\"r-pagination-loading-empty-next\"></div>\n        </div>,\n      ]);\n    }\n\n    function renderBegin() {\n      return renderSlot(ctx.slots, \"begin\", {}, () => [\n        <div class=\"r-pagination-loading-begin\">\n          <div class=\"r-pagination-loading-begin-loading\">\n            <div class=\"r-pagination-loading-begin-prve\"></div>\n            <div class=\"r-pagination-loading-begin-text\">加载中</div>\n            <div class=\"r-pagination-loading-begin-next\"></div>\n          </div>\n          <div class=\"r-pagination-loading-begin-skeleton\">\n            {renderList(10, () => (\n              <div class=\"r-pagination-loading-begin-skeleton-item\" />\n            ))}\n          </div>\n        </div>,\n      ]);\n    }\n\n    function onBeginErrorClick() {\n      if (props.onBeginErrorClick) props.onBeginErrorClick(...arg);\n      else props.loadingHook?.nextBeginSend?.();\n    }\n\n    function renderError() {\n      return renderSlot(ctx.slots, \"error\", {}, () => [\n        <div class=\"r-pagination-loading-begin-error\" onClick={onBeginErrorClick}>\n          <div class=\"r-pagination-loading-begin-error-prve\"></div>\n          <div class=\"r-pagination-loading-begin-error-text\">出错了 点击重新加载</div>\n          <div class=\"r-pagination-loading-begin-error-next\"></div>\n        </div>,\n      ]);\n    }\n\n    function onErrorLoadClick(...arg) {\n      if (props.onErrorLoadClick) props.onErrorLoadClick(...arg);\n      else props.loadingHook?.awaitSend?.();\n    }\n\n    function renderLoadError() {\n      return renderSlot(ctx.slots, \"errorLoad\", {}, () => [\n        <div class=\"r-pagination-loading-error\" onClick={onErrorLoadClick}>\n          <div class=\"r-pagination-loading-error-prve\"></div>\n          <div class=\"r-pagination-loading-error-text\">出错了 点击重新加载</div>\n          <div class=\"r-pagination-loading-error-next\"></div>\n        </div>,\n      ]);\n    }\n\n    function renderState() {\n      const ps = props.loadingHook;\n      if (ps.begin === true && ps.error === true) return renderError();\n      if (ps.error === true) return renderLoadError();\n      if (ps.begin === true) return renderBegin();\n      if (ps.empty === true && ps.finished === true) return renderEmpty();\n      if (ps.finished === true) return renderFinished();\n      if (ps.loading === true) return renderLoading();\n    }\n\n    return (v, a) => {\n      vm = v;\n      return [ctx.slots?.default?.(), renderState()];\n    };\n  },\n});\n","import { useSlots as _useSlots } from 'vue'\nimport { renderSlot as _renderSlot, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"keyExtractor\"]\n\nimport { render, defineComponent, computed, toRaw } from \"vue\";\r\n\r\n\nexport default {\n  __name: 'index',\n  props: {\r\n  modelValue: { type: Array, default: () => [] },\r\n  keyExtractor: { type: Function, default: (val) => val.item },\r\n  listHook: { type: Object, default: () => ({}) },\r\n},\n  emits: [\"update:modelValue\"],\n  setup(__props, { emit: __emit }) {\n\r\nconst slots = _useSlots();\r\nconst emit = __emit;\r\nconst props = __props;\r\n\r\nconst list = computed({\r\n  set(val) {\r\n    if (props.listHook.list) return (props.listHook.list = val);\r\n    emit(\"update:modelValue\", val);\r\n  },\r\n  get() {\r\n    if (props.listHook.list) return props.listHook.list;\r\n    return toRaw(props.modelValue);\r\n  },\r\n});\r\n\r\nconst refList = computed(() => {\r\n  if (props.listHook.list) return props.listHook.list;\r\n  return props.modelValue;\r\n});\r\n\r\nconst Item = defineComponent({\r\n  inheritAttrs: false,\r\n  props: {\r\n    event: Object,\r\n    slots: Object,\r\n  },\r\n  setup(props) {\r\n    return () => {\r\n      return props?.slots?.item?.(props.event);\r\n    };\r\n  },\r\n});\r\n\r\nfunction onRenderItems(event) {\r\n  event.item = refList.value[event.index];\r\n  render(\r\n    <Item\r\n      event={event}\r\n      slots={slots}\r\n      key={props.keyExtractor(event)}\r\n      data-key={props.keyExtractor(event)}\r\n    ></Item>,\r\n    event.ele,\r\n  );\r\n}\r\n\nreturn (_ctx, _cache) => {\n  return _withDirectives((_openBlock(), _createElementBlock(\"r-scroll-virtual-grid-list\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => ((list).value = $event)),\n    onrenderItems: onRenderItems,\n    keyExtractor: props.keyExtractor\n  }, [\n    _renderSlot(_ctx.$slots, \"default\")\n  ], 8, _hoisted_1)), [\n    [_vModelText, list.value]\n  ])\n}\n}\n\n}","import VirtualGridList from \"./index.vue\";\r\nexport const VRVirtualGridList = VirtualGridList;\r\n","import { useSlots as _useSlots } from 'vue'\nimport { renderSlot as _renderSlot, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = [\"keyExtractor\"]\n\nimport { render, defineComponent, computed, toRaw, onMounted } from \"vue\";\n\n\nexport default {\n  __name: 'index',\n  props: {\n  modelValue: { type: Array, default: () => [] },\n  keyExtractor: { type: Function, default: (val) => val.item },\n  listHook: { type: Object, default: () => ({}) },\n},\n  emits: [\"update:modelValue\"],\n  setup(__props, { emit: __emit }) {\n\nconst slots = _useSlots();\nconst emit = __emit;\nconst props = __props;\n\nconst list = computed({\n  set(val) {\n    if (props.listHook.list) return (props.listHook.list = val);\n    emit(\"update:modelValue\", val);\n  },\n  get() {\n    if (props.listHook.list) return props.listHook.list;\n    return toRaw(props.modelValue);\n  },\n});\n\nconst refList = computed(() => {\n  if (props.listHook.list) return props.listHook.list;\n  return props.modelValue;\n});\n\nconst Item = defineComponent({\n  inheritAttrs: false,\n  props: {\n    event: Object,\n    slots: Object,\n  },\n  setup(props) {\n    onMounted(() => { });\n    return () => {\n      return props?.slots?.item?.(props.event);\n    };\n  },\n});\n\nfunction onRenderItems(event) {\n  event.item = refList.value[event.index];\n  render(\n    <Item\n      event={event}\n      slots={slots}\n      key={props.keyExtractor(event)}\n      data-key={props.keyExtractor(event)}\n    ></Item>,\n    event.ele,\n  );\n}\n\nreturn (_ctx, _cache) => {\n  return _withDirectives((_openBlock(), _createElementBlock(\"r-scroll-virtual-falls-list\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => ((list).value = $event)),\n    onrenderItems: onRenderItems,\n    keyExtractor: props.keyExtractor\n  }, [\n    _renderSlot(_ctx.$slots, \"default\")\n  ], 8, _hoisted_1)), [\n    [_vModelText, list.value]\n  ])\n}\n}\n\n}","import VirtualFallsList from \"./index.vue\";\r\n\r\nexport const VRVirtualFallsList = VirtualFallsList;\r\n","import {\n  defineComponent,\n  computed,\n  reactive,\n  provide,\n  render,\n  watch,\n  onMounted,\n  renderList,\n  onBeforeUnmount,\n} from \"vue\";\nimport { useScrollController, useFallsLayout, arrayBinaryFindIndex } from \"../utils.js\";\nimport { useResizeObserver } from \"@rainbow_ljy/v-hooks\";\nimport { animationDebounced } from \"@rainbow_ljy/rainbow-js\";\n\nconst mProps = {\n  avgHeight: { type: Number, default: 200 }, // 每个item高度\n  keyExtractor: { type: Function, default: ({ index }) => index },\n  columns: { type: Number, default: 1 }, // 一行几个item\n  gap: { type: Number, default: 10 }, // 列表之间空格的间距\n  inline: Boolean,\n  minWidth: Number,\n  listHook: Object,\n  list: Array,\n  preLoadsCount: { type: Number, default: 100 },\n  renderCount: { type: Number, default: 30 },\n};\n\nconst CONTEXT = defineComponent({\n  props: {\n    list: Array,\n  },\n  setup(props, context) {\n    return () => {\n      renderList(props.list || [], (item, index) => null);\n      return null;\n    };\n  },\n});\n\nconst ListenerList = defineComponent({\n  props: {\n    list: Array,\n  },\n  setup(props, context) {\n    return () => {\n      return <CONTEXT list={props.list}></CONTEXT>;\n    };\n  },\n});\n\nconst Item = defineComponent({\n  props: {\n    item: Object,\n    index: Number,\n    slots: Object,\n  },\n  setup(props, context) {\n    let vm;\n    const rObserver = useResizeObserver(() => vm.$el, onSizeChange);\n\n    function onSizeChange(events) {\n      const height = events?.[0]?.target?.offsetHeight ?? 0;\n      const oldHeight = props.item?.__cache__?.height ?? 0;\n      if (height === 0) return;\n      if (oldHeight !== height) {\n        if (props.item?.__cache__) {\n          props.item.__cache__.height = height;\n          props.item.__cache__.isResize = true;\n          context.emit(\"heightChange\", height, oldHeight, events);\n        }\n      }\n    }\n\n    return (el) => {\n      vm = el;\n      return (\n        <div class=\"r-scroll-virtual-falls-list-item-content\">{props?.slots?.default?.(props)}</div>\n      );\n    };\n  },\n});\n\nexport const RScrollVirtualFallsListV3 = defineComponent({\n  props: {\n    ...mProps,\n  },\n  setup(props, context) {\n    let contentHtml;\n    let watchLock = false;\n    const falls = useFallsLayout(props);\n    const LIST = computed(() => (props.listHook ? props.listHook.list : props.list) || []);\n    const backstage = createBackstage();\n\n    const CACHE = {\n      nodeMap: new Map(),\n      DivPointer: undefined,\n      renderList: [],\n      item: undefined,\n    };\n\n    const mCtx = reactive({\n      context,\n      slots: context.slots,\n      index: 0,\n      endIndex: 0,\n      column: falls.getMinHeightItem(),\n      endColumn: falls.getMinHeightItem(),\n      nodeMap: new Map(),\n      renderList: [],\n      renderItems,\n    });\n\n    provide(\"RScrollVirtualFallsListContext\", mCtx);\n    context.expose(mCtx);\n    const onResizeDebounced = animationDebounced(onResize);\n    const onHeightChange = animationDebounced(onChangeHeight);\n    const scrollController = useScrollController({ onScroll, onResize: onResizeDebounced });\n    const scrollTop = () => scrollController?.context?.element?.scrollTop ?? 0;\n    const minHeight = computed(() => {\n      if (!LIST.value.length) return 0;\n      return (\n        (props.avgHeight + props.gap) * Math.ceil(LIST.value.length / props.columns) - props.gap\n      );\n    });\n    const recycleTop = () => -window.innerHeight + scrollController.getOffsetTop(contentHtml);\n    const recycleBottom = () => window.innerHeight * 2 + scrollController.getOffsetTop(contentHtml);\n\n    function renderItems() {\n      if (!contentHtml) return;\n      backstage.stop();\n      let node = mCtx.column;\n      mCtx.nodeMap = new Map();\n      CACHE.DivPointer = undefined;\n\n      mCtx.renderList.forEach((ele, nth) => {\n        if (!ele.__cache__) ele.__cache__ = {};\n        const index = mCtx.index + nth;\n        const __cache__ = ele.__cache__;\n        __cache__.columns = falls.list.map((el) => ({ ...el }));\n        if (node.height) node.height = node.height + props.gap;\n        __cache__.top = node.height;\n        __cache__.left = node.left;\n        __cache__.width = node.width;\n        __cache__.columnIndex = node.index;\n\n        let div;\n        if (CACHE.nodeMap.has(ele)) {\n          div = CACHE.nodeMap.get(ele);\n          div.setAttribute(\"data-index\", index);\n          render(\n            <Item\n              item={ele}\n              index={index}\n              slots={context.slots}\n              key={props.keyExtractor({ item: ele, index })}\n              onHeightChange={onHeightChange}\n            ></Item>,\n            div,\n          );\n          // console.log('缓存有', div);\n          if (CACHE.DivPointer) {\n            if (CACHE.DivPointer.nextSibling === div) {\n              // 当 当前指针的下一个和要渲染的div相同\n            } else {\n              contentHtml.insertBefore(div, CACHE.DivPointer.nextSibling);\n            }\n          }\n          CACHE.DivPointer = div;\n          CACHE.nodeMap.delete(ele);\n        } else {\n          // console.log('没有则创建', index);\n          div = document.createElement(\"div\");\n          div.setAttribute(\"data-index\", index);\n          div.classList.add(\"r-scroll-virtual-falls-list-item\");\n          render(\n            <Item\n              item={ele}\n              index={index}\n              slots={context.slots}\n              key={props.keyExtractor({ item: ele, index })}\n              onHeightChange={onHeightChange}\n            ></Item>,\n            div,\n          );\n          if (!CACHE.DivPointer) {\n            contentHtml.insertBefore(div, contentHtml.firstChild);\n            CACHE.DivPointer = div;\n          } else {\n            contentHtml.insertBefore(div, CACHE.DivPointer.nextSibling);\n            CACHE.DivPointer = div;\n          }\n        }\n\n        div.style.top = __cache__.top + \"px\";\n        div.style.left = __cache__.left;\n        div.style.width = __cache__.width;\n        __cache__.height = div.offsetHeight;\n        node.height = node.height + div.offsetHeight;\n        __cache__.bottom = node.height;\n        __cache__.vTop = __cache__.top + recycleTop();\n        __cache__.vBottom = __cache__.bottom + recycleBottom();\n        __cache__.columns2 = falls.list.map((el) => ({ ...el }));\n\n        mCtx.endIndex = index + 1;\n        node = falls.getMinHeightItem();\n        mCtx.endColumn = node;\n        mCtx.nodeMap.set(ele, div);\n      });\n      // console.log('renderItems', mCtx);\n      CACHE.nodeMap.forEach((div) => div.remove());\n      CACHE.DivPointer = undefined;\n      CACHE.nodeMap = mCtx.nodeMap;\n      watchLock = false;\n\n      backstage.rePreLoads();\n      backstage.start();\n    }\n\n    function layout(isForce) {\n      let index = findIndex(scrollTop());\n      if (index === -1) index = 0;\n      if( LIST.value.length === 0 && contentHtml){\n        contentHtml.innerHTML = ''\n        return\n      }\n      let item = LIST.value[index];\n      if (!item) return;\n      if (!isForce && CACHE.item === item) return;\n      watchLock = true;\n      mCtx.index = index;\n      // console.log('layout-index', index);\n      let cache = item.__cache__;\n      if (index === 0) {\n        falls.setList();\n        mCtx.column = falls.getMinHeightItem();\n      } else {\n        falls.list = cache.columns;\n        mCtx.column = falls.getMinHeightItem(cache.columnIndex);\n      }\n      mCtx.renderList = LIST.value.slice(mCtx.index, mCtx.index + props.renderCount);\n      CACHE.item = item;\n      renderItems();\n    }\n\n    function findIndex(sTop) {\n      return arrayBinaryFindIndex(\n        LIST.value,\n        (item) => {\n          if (!item.__cache__) return false;\n          return item.__cache__.vTop <= sTop && sTop <= item.__cache__.vBottom;\n        },\n        (item) => {\n          if (!item.__cache__) return false;\n          return item.__cache__.vTop < sTop;\n        },\n      );\n    }\n\n    function getHeight() {\n      const columns = LIST.value.at(-1)?.__cache__?.columns2;\n      if (!columns) return minHeight.value;\n      let col = columns[0];\n      columns.forEach((el) => {\n        if (el.height > col.height) col = el;\n      });\n      return col.height;\n    }\n\n    function createBackstage() {\n      let timer;\n      let index = 0;\n      let column;\n      const requestTimer = window.requestIdleCallback || requestAnimationFrame;\n      const cancelRequestTimer = window.requestIdleCallback ? cancelIdleCallback : cancelAnimationFrame;\n\n      function rePreLoads() {\n        index = mCtx.endIndex;\n        column = mCtx.endColumn;\n        preLoads();\n      }\n\n      function preLoad() {\n        const ele = LIST.value[index];\n        if (!ele) return;\n        let node = column;\n        if (!ele.__cache__) ele.__cache__ = {};\n        const cache__height = ele.__cache__.height || props.avgHeight;\n        ele.__cache__.columns = falls.list.map((el) => ({ ...el }));\n        if (node.height) node.height = node.height + props.gap;\n        ele.__cache__.top = node.height;\n        ele.__cache__.left = node.left;\n        ele.__cache__.width = node.width;\n        ele.__cache__.columnIndex = node.index;\n        ele.__cache__.height = cache__height;\n        node.height = node.height + cache__height;\n        ele.__cache__.bottom = node.height;\n        ele.__cache__.columns2 = falls.list.map((el) => ({ ...el }));\n        ele.__cache__.vTop = ele.__cache__.top + recycleTop();\n        ele.__cache__.vBottom = ele.__cache__.bottom + recycleBottom();\n        index++;\n        column = falls.getMinHeightItem();\n      }\n\n      function preLoads(count = props.preLoadsCount) {\n        let nth = 0;\n        while (nth < props.preLoadsCount) {\n          preLoad();\n          nth++;\n        }\n      }\n\n      function idleCallback(deadline) {\n        if (index >= LIST.value.length) {\n          stop();\n          return;\n        }\n\n        const hasTimeRemaining =\n          typeof deadline === \"object\" && deadline.timeRemaining && deadline.timeRemaining() > 0;\n\n        if (hasTimeRemaining || typeof deadline === \"number\") {\n          try {\n            preLoads(10);\n          } catch (error) {\n            console.error(\"Error in callback:\", error);\n          }\n\n          if (\n            (typeof deadline === \"object\" && !deadline.didTimeout) ||\n            typeof deadline === \"number\"\n          ) {\n            timer = requestTimer(idleCallback);\n          }\n        }\n      }\n\n      function start() {\n        timer = requestTimer(idleCallback);\n      }\n\n      function stop() {\n        if (timer) {\n          cancelRequestTimer(timer);\n          timer = null;\n        }\n      }\n\n      function trigger() {\n        requestTimer(idleCallback);\n      }\n\n      return { start, stop, trigger, preLoads, preLoad, rePreLoads };\n    }\n\n    onMounted(() => {});\n\n    onBeforeUnmount(() => {\n      backstage.stop();\n    });\n\n    function onChangeHeight() {\n      // console.log('onChangeHeight');\n      layout(true);\n    }\n\n    function onScroll() {\n      // console.log('onScroll');\n      layout();\n    }\n\n    function onResize() {\n      // console.log('onResize', LIST.value);\n      layout(true);\n    }\n\n    watch(\n      () => LIST.value.slice(mCtx.index, mCtx.index + props.renderCount),\n      () => {\n        // console.log('list ------ watch', watchLock);\n        if (watchLock) return;\n        layout(true);\n      },\n    );\n\n    watch(\n      () => LIST.value.length,\n      () => {\n        if (watchLock) return;\n        layout(true);\n      },\n    );\n\n    return () => {\n      return (\n        <div>\n          <ListenerList\n            list={LIST.value.slice(mCtx.index, mCtx.index + props.renderCount)}\n          ></ListenerList>\n          <div\n            style={{ height: getHeight() + \"px\" }}\n            data-length={LIST.value.length}\n            ref={(el) => (contentHtml = el)}\n            class=\"r-scroll-virtual-falls-list\"\n          ></div>\n        </div>\n      );\n    };\n  },\n});\n","import {\n  defineComponent,\n  renderSlot,\n  renderList,\n  computed,\n  inject,\n  reactive,\n  provide,\n  onBeforeMount,\n  onMounted\n} from \"vue\";\nimport { useScrollController } from \"../utils.js\";\nimport { arrayLoop } from \"@rainbow_ljy/rainbow-js\";\nimport './index.scss'\n\nconst mProps = {\n  bothEndsHeight: { type: Number, default: 0 }, //列表 两端的高度\n  avgHeight: { type: Number, default: 120 }, // 每个item高度\n  keyExtractor: { type: Function, default: ({ index }) => index },\n  columns: { type: Number, default: 1 }, // 一行几个item\n  gap: { type: Number, default: 10 }, // 列表之间空格的间距\n  minAutoWidth: Number,\n  listHook: Object,\n  list: Array,\n  openAnimationFrame: Boolean,\n  //\n};\n\n\nconst RScrollVirtualGridListItem = defineComponent({\n  props: {\n    item: [Object, Array, String, Number],\n    index: Number,\n  },\n  setup(props, context) {\n    const mCtx = inject(\"RScrollVirtualGridListContext\") || {};\n    let html;\n\n    const obs = new IntersectionObserver(([entries]) => {\n      if (!entries.isIntersecting) return\n      mCtx.context.emit(\"itemVisible\", props);\n      handleMarkVisible();\n    });\n\n    function handleMarkVisible() {\n      if (typeof props.item !== 'object') return;\n      if (props.item.__markVisible !== mCtx.markVisible) {\n        props.item.__markVisible = mCtx.markVisible;\n        mCtx.context.emit(\"itemMarkVisible\", props);\n      }\n    }\n\n    onMounted(() => {\n      obs.observe(html);\n    })\n\n    onBeforeMount(() => {\n      obs.disconnect();\n    })\n\n\n    return () => {\n      return <div ref={(el) => html = el}   >\n        {renderSlot(context.slots, \"default\", props)}\n      </div>\n    }\n  }\n})\n\n\nconst Context = defineComponent({\n  props: {\n    ...mProps,\n  },\n  setup(props, context) {\n    const mCtx = inject(\"RScrollVirtualGridListContext\") || {};\n\n    function handleMark(item) {\n      if (typeof item.item !== 'object') return;\n      if (item.item.__markCount !== mCtx.markCount) {\n        item.item.__markCount = mCtx.markCount;\n        mCtx.context.emit(\"itemMarkRender\", item);\n      }\n    }\n\n    return () => {\n      return renderList(mCtx.renderList, (item, index) => {\n        handleMark(item);\n        return <RScrollVirtualGridListItem\n          data-index={item.index}\n          class=\"r-scroll-virtual-grid-list-item\"\n          style={item.style}\n          item={item.item}\n          index={item.index}\n          key={props.keyExtractor(item)}\n        >\n          {renderSlot(mCtx.slots, \"default\", item)}\n        </RScrollVirtualGridListItem>\n        // return (\n        //   <div ref={(el) => onRef(el, item)} data-index={item.index} class=\"r-scroll-virtual-grid-list-item\" style={item.style} key={props.keyExtractor(item)}>\n        //     {renderSlot(mCtx.slots, \"default\", item)}\n        //   </div>\n        // );\n      });\n    };\n  },\n});\n\nexport const RScrollVirtualGridList = defineComponent({\n  props: {\n    ...mProps,\n  },\n  emits: [\"itemMarkRender\", \"itemMarkVisible\", \"itemVisible\"],\n  setup(props, context) {\n    let cache = {\n      index: undefined,\n    }\n    let contentHtml;\n    const recycleHeight = () => window.innerHeight;  //window.innerHeight; // 有些浏览器初始拿innerHeight有时为0;\n    const itemWidth = computed(() => `calc( ${100 / props.columns}% - ${((props.columns - 1) * props.gap) / props.columns}px )`);\n    const LIST = computed(() => (props.listHook ? props.listHook.list : props.list) || []);\n    const HEIGHT = computed(() => {\n      if (!LIST.value.length) return 0;\n      return (\n        (props.avgHeight + props.gap) * Math.ceil(LIST.value.length / props.columns) -\n        props.gap +\n        props.bothEndsHeight * 2\n      );\n    });\n\n\n    const scrollController = useScrollController({\n      onScroll(event, sTop) {\n        layout();\n      },\n      onResize(entries, sTop) {\n        layout();\n      },\n    });\n\n\n    const mCtx = reactive({\n      context,\n      slots: context.slots,\n\n      itemWidth,\n      height: HEIGHT,\n      renderList: [],\n\n      markCount: 0,\n      markVisible: 0,\n      // onRender: () => undefined,\n      // addMarkCount() {\n      //   mCtx.markCount++;\n      // },\n      // doAddMark() {\n      //   mCtx.addMarkCount();\n      //   mCtx.doMark();\n      // },\n      // doMark() {\n      //   mCtx.renderList.forEach(({ item }) => {\n      //     item.__markCount = mCtx.markCount;\n      //   });\n      // },\n    });\n\n\n    provide(\"RScrollVirtualGridListContext\", mCtx);\n\n    context.expose(mCtx);\n\n    function getLeft(i) {\n      return `calc( ${(100 / props.columns) * i}% - ${(((props.columns - 1) * props.gap) / props.columns) * i\n        }px + ${i * props.gap}px )`;\n    }\n\n\n\n    function getRenderList(index, addH = 0, pList = []) {\n      const sTop = scrollController.context.element.scrollTop;\n      const offsetTop = scrollController.getOffsetTop(contentHtml);\n      if (index >= LIST.value.length) return pList;\n\n      arrayLoop(props.columns, (i) => {\n        if (index >= 0) {\n          const nth = Math.floor(index / props.columns);\n          let top = nth * (props.avgHeight + props.gap) + props.bothEndsHeight + \"px\";\n          if (nth === 0) top = props.bothEndsHeight + \"px\";\n          const left = getLeft(i);\n          const width = itemWidth.value;\n          const height = props.avgHeight + \"px\";\n          pList.push({\n            index,\n            style: { top, left, width, height },\n            item: LIST.value[index],\n          });\n        }\n\n        index++;\n      });\n      addH = addH + props.avgHeight + props.gap;\n      if (addH < window.innerHeight + recycleHeight() * 2) return getRenderList(index, addH, pList);\n      return pList;\n    }\n\n    function doLayout(isCache = true) {\n      if (!scrollController.context.element) return;\n      const sTop = scrollController.context.element.scrollTop;\n      const offsetTop = scrollController.getOffsetTop(contentHtml);\n      const renderTop = offsetTop - sTop - window.innerHeight - recycleHeight();\n      if (renderTop > 0) return;\n      let aaa = Math.floor(recycleHeight() / (props.avgHeight + props.gap)) * props.columns\n      let bbb = Math.floor((sTop - offsetTop) / (props.avgHeight + props.gap)) * props.columns;\n      let index = bbb - aaa\n      if (cache.index === index && isCache) return;\n      cache.index = index;\n      mCtx.renderList = getRenderList(index);\n      // console.log('---------layout ---------');\n      // console.log(`renderTop : ${renderTop}`);\n      // console.log(`index : ${index}`);\n      // console.log(mCtx.renderList);\n      // console.log('  ');\n    }\n\n    let time;\n    function layout(isCache = true) {\n      if (!props.openAnimationFrame) return doLayout(isCache)\n      cancelAnimationFrame(time)\n      time = requestAnimationFrame(() => {\n        doLayout(isCache)\n      })\n    }\n\n    return () => {\n      // console.log('---------render ---------');\n      layout(false);\n      return (\n        <div\n          data-length={LIST.value.length}\n          ref={(el) => (contentHtml = el)}\n          style={{ height: HEIGHT.value + \"px\" }}\n          class=\"r-scroll-virtual-grid-list\"\n        >\n          <Context keyExtractor={props.keyExtractor}></Context>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["VRTabs","Tabs","useScrollController","props","RScrollContext","inject","controller","reactive","destroy","getOffsetTop","dispatchFlotage","_b","_a","ele","top","arg","element","arrayRemove","onBeforeUnmount","useFallsLayout","options","config","args","getWidth","setColumns","afreshConfig","push","layout","setConfig","setWidth","afreshLayout","getMaxHeightItem","getMinHeightItem","setList","getList","arrayLoopMap","i","getLeft","getColumns","width","item","el","index","conf","items","node","arrayBinarySearch","setPointer","arr","formatter","compare","fg","arrayBinaryFindIndex","VRPaginationLoading","defineComponent","ctx","onScrollDown","event","max","vm","scrollView","onMounted","mounted","onUnmounted","unmounted","findParentByLocalName","onScrollUp","renderLoading","renderSlot","_createVNode","_createTextVNode","renderFinished","renderEmpty","renderBegin","renderList","onBeginErrorClick","renderError","onErrorLoadClick","renderLoadError","renderState","ps","v","a","_hoisted_1","_sfc_main$1","val","__props","__emit","slots","_useSlots","emit","list","computed","toRaw","refList","Item","onRenderItems","render","_ctx","_cache","_withDirectives","_openBlock","_createElementBlock","$event","_renderSlot","_vModelText","VRVirtualGridList","VirtualGridList","_sfc_main","VRVirtualFallsList","VirtualFallsList","mProps","CONTEXT","context","ListenerList","useResizeObserver","onSizeChange","events","height","oldHeight","_d","_c","_e","RScrollVirtualFallsListV3","contentHtml","watchLock","falls","LIST","backstage","createBackstage","CACHE","mCtx","renderItems","provide","onResizeDebounced","animationDebounced","onResize","onHeightChange","onChangeHeight","scrollController","onScroll","scrollTop","minHeight","recycleTop","recycleBottom","nth","__cache__","div","isForce","findIndex","cache","sTop","getHeight","columns","col","timer","column","requestTimer","cancelRequestTimer","rePreLoads","preLoads","preLoad","cache__height","count","idleCallback","deadline","stop","error","start","trigger","watch","_isSlot","s","_isVNode","RScrollVirtualGridListItem","html","obs","entries","handleMarkVisible","onBeforeMount","Context","handleMark","_slot","RScrollVirtualGridList","recycleHeight","itemWidth","HEIGHT","getRenderList","addH","pList","arrayLoop","left","doLayout","isCache","offsetTop","aaa","time"],"mappings":"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"}